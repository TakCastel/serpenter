import{c as oe,_ as se,a as ae}from"./Do5DnKWl.js";import{u as V}from"./DekLO5mZ.js";import H from"./NY8DXe15.js";import{a2 as W,j as D,c as l,o as s,a as e,b as n,l as _,t as $,f as C,ai as L,n as z,k as q,e as F,u as O,r as j,H as le,a6 as ne,w as A,_ as ie,ag as Y,ah as G,a3 as B,m as R,$ as Z,a0 as J,g as Q,h as X,aj as ee,Z as ce,p as de}from"./B68XTRoa.js";import{_ as ue,u as re}from"./LtcIMBXo.js";import{u as K}from"./BZNdWMhY.js";import{_ as me}from"./CpKchkGe.js";import{M as te,u as pe}from"./Dy1c3Y_b.js";const ve={class:"flex items-center space-x-4"},he=["title","aria-label"],be={class:"flex items-center space-x-3"},ge={class:"flex flex-col"},ye={class:"font-bold tracking-tight text-xl text-emerald-500"},fe={class:"text-xs text-gray-600"},xe={__name:"DashboardHeaderLeftSection",props:{isSidebarCollapsed:{type:Boolean,default:!1}},emits:["toggle-sidebar"],setup(t){const{t:w,te:p,locale:h}=W({useScope:"global"}),a=D(()=>p&&p("app.title")?w("app.title"):"Serpenter"),d=D(()=>p&&p("app.subtitle")?w("app.subtitle"):(h?.value==="fr","Check, Check. Go."));return(i,m)=>{const f=H;return s(),l("div",ve,[e("button",{onClick:m[0]||(m[0]=g=>i.$emit("toggle-sidebar")),class:"w-10 h-10 rounded-lg flex items-center justify-center transition-all duration-200 hover:scale-105 hover:shadow-md",style:{backgroundColor:"var(--button-bg)",borderColor:"var(--button-border)",color:"var(--text-primary)"},title:t.isSidebarCollapsed?"Ouvrir la barre latérale":"Réduire la barre latérale","aria-label":t.isSidebarCollapsed?"Ouvrir la barre latérale":"Réduire la barre latérale"},[n(f,{name:t.isSidebarCollapsed?"heroicons:bars-3":"heroicons:x-mark",class:_(["w-5 h-5 transition-transform duration-300",{"rotate-180":!t.isSidebarCollapsed}]),style:{color:"var(--text-primary)"}},null,8,["name","class"])],8,he),e("div",be,[n(f,{name:"fluent-emoji:snake",class:"w-8 h-8 sm:w-10 sm:h-10","aria-hidden":"true"}),e("div",ge,[e("h1",ye,$(a.value),1),e("span",fe,$(d.value),1)])])])}}},we={class:"hidden lg:flex items-center justify-center flex-1 max-w-md mx-8"},ke={key:0,class:"flex items-center space-x-3"},Ce={class:"relative w-12 h-12"},je={class:"w-12 h-12 transform -rotate-90",viewBox:"0 0 36 36"},$e=["stroke-dasharray"],Se={class:"absolute inset-0 flex items-center justify-center"},Pe={class:"text-xs font-semibold text-gray-700 transition-colors duration-200"},_e={__name:"DashboardHeaderCenterSection",props:{progressPercentage:{type:Number,default:null},currentProjectId:{type:String,default:null}},setup(t){return(w,p)=>(s(),l("div",we,[t.progressPercentage!==null&&t.currentProjectId&&(w._.provides[L]||w.$route).path==="/dashboard"?(s(),l("div",ke,[e("div",Ce,[(s(),l("svg",je,[p[0]||(p[0]=e("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#e5e7eb","stroke-width":"2","stroke-linecap":"round"},null,-1)),e("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#059669","stroke-width":"2","stroke-linecap":"round","stroke-dasharray":`${t.progressPercentage*1.131}, 100`,class:"transition-all duration-500 ease-out"},null,8,$e)])),e("div",Se,[e("span",Pe,$(Math.round(t.progressPercentage))+"% ",1)])]),p[1]||(p[1]=e("div",{class:"text-sm text-gray-600"},[e("div",{class:"font-medium"},"Progression du projet"),e("div",{class:"text-xs text-gray-500"},"terminé")],-1))])):C("",!0)]))}},Me={class:"flex items-center space-x-3",role:"toolbar","aria-label":"Actions de l'application"},Te=["aria-expanded"],Ue={key:0,class:"relative"},Le=["aria-expanded"],Ee={class:"w-8 h-8 rounded-full overflow-hidden ring-2 ring-emerald-200 hover:ring-emerald-300 transition-all duration-200"},De=["src","alt"],Ne={key:1,class:"w-full h-full bg-gradient-to-br from-emerald-400 to-emerald-600 flex items-center justify-center"},Ie={class:"hidden md:block text-left"},Re={class:"text-sm font-semibold",style:{color:"var(--text-primary)"}},Be={class:"text-xs",style:{color:"var(--text-secondary)"}},Ae={key:0,class:"absolute top-full right-0 mt-3 w-72 rounded-2xl border shadow-2xl z-50 backdrop-blur-sm",style:{backgroundColor:"var(--bg-surface)",borderColor:"var(--bg-border)"},role:"menu","aria-label":"Menu utilisateur"},He={class:"px-6 py-6 text-center border-b",style:{borderColor:"var(--bg-border)"}},Oe={class:"flex flex-col items-center space-y-3"},ze={class:"w-16 h-16 rounded-full overflow-hidden ring-4 ring-emerald-100 hover:ring-emerald-200 transition-all duration-200"},Ve=["src","alt"],qe={key:1,class:"w-full h-full bg-gradient-to-br from-emerald-400 to-emerald-600 flex items-center justify-center"},Fe={class:"text-lg font-bold",style:{color:"var(--text-primary)"}},Ke={class:"text-sm",style:{color:"var(--text-secondary)"}},Ye={class:"p-4 space-y-3"},Ge={class:"p-4"},We={__name:"DashboardHeaderRightSection",props:{isClient:{type:Boolean,default:!1},showMobileMenu:{type:Boolean,default:!1},showUserMenu:{type:Boolean,default:!1},userLoggedIn:{type:Boolean,default:!1},currentUser:{type:Object,default:null}},emits:["toggle-mobile-menu","toggle-user-menu","logout"],setup(t,{emit:w}){const{signOut:p}=K(),h=w,a=async()=>{try{await p(),h("logout"),await z("/login")}catch{await z("/login")}};return(d,i)=>{const m=H;return s(),l("div",Me,[e("button",{onClick:i[0]||(i[0]=f=>d.$emit("toggle-mobile-menu")),class:"sm:hidden w-10 h-10 rounded-lg flex items-center justify-center transition-colors duration-200",style:{backgroundColor:"var(--button-bg)",borderColor:"var(--button-border)",color:"var(--text-primary)"},"aria-expanded":t.showMobileMenu,"aria-label":"Ouvrir le menu mobile"},[n(m,{name:"heroicons:ellipsis-vertical",class:"w-5 h-5",style:{color:"var(--text-primary)"}})],8,Te),t.userLoggedIn?(s(),l("div",Ue,[e("button",{onClick:i[1]||(i[1]=f=>d.$emit("toggle-user-menu")),class:"flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors duration-200 hover:bg-opacity-80",style:{backgroundColor:"var(--button-bg)",color:"var(--text-primary)"},"aria-expanded":t.showUserMenu,"aria-label":"Menu utilisateur"},[e("div",Ee,[t.currentUser?.photoURL?(s(),l("img",{key:0,src:t.currentUser.photoURL,alt:t.currentUser?.displayName||"Avatar",class:"w-full h-full object-cover"},null,8,De)):(s(),l("div",Ne,[n(m,{name:"heroicons:user",class:"w-4 h-4 text-white"})]))]),e("div",Ie,[e("div",Re,$(t.currentUser?.displayName||t.currentUser?.email?.split("@")[0]||"Utilisateur"),1),e("div",Be,$(t.currentUser?.email||"Membre actif"),1)]),n(m,{name:"heroicons:chevron-down",class:_(["w-4 h-4 transition-transform duration-200",{"rotate-180":t.showUserMenu}]),style:{color:"var(--text-muted)"}},null,8,["class"])],8,Le),t.showUserMenu?(s(),l("div",Ae,[e("div",He,[e("div",Oe,[e("div",ze,[t.currentUser?.photoURL?(s(),l("img",{key:0,src:t.currentUser.photoURL,alt:t.currentUser?.displayName||"Avatar",class:"w-full h-full object-cover"},null,8,Ve)):(s(),l("div",qe,[n(m,{name:"heroicons:user",class:"w-8 h-8 text-white"})]))]),e("div",null,[e("div",Fe,$(t.currentUser?.displayName||t.currentUser?.email?.split("@")[0]||"Utilisateur"),1),e("div",Ke,$(t.currentUser?.email||"Membre actif"),1)])])]),e("div",Ye,[n(ue,{size:"sm",context:"dropdown"})]),i[3]||(i[3]=e("div",{class:"border-t mx-4",style:{borderColor:"var(--bg-border)"}},null,-1)),e("div",Ge,[e("button",{onClick:a,class:"w-full px-4 py-3 text-left text-sm transition-all duration-200 hover:bg-opacity-90 rounded-xl bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:hover:bg-red-900/30 text-red-600 flex items-center justify-center space-x-3 font-medium"},[n(m,{name:"heroicons:arrow-right-on-rectangle",class:"w-5 h-5 text-red-500"}),i[2]||(i[2]=e("span",null,"Se déconnecter",-1))])])])):C("",!0)])):C("",!0)])}}},Ze={key:0,class:"sm:hidden mt-3 px-1",role:"menu","aria-label":"Menu mobile"},Je={class:"rounded-lg border border-gray-200 bg-white shadow-lg"},Qe={class:"p-2 space-y-1"},Xe={class:"grid grid-cols-2 gap-2 px-2"},et={class:"border-t border-gray-100 pt-2"},tt={__name:"DashboardHeaderMobileMenu",props:{showMobileMenu:{type:Boolean,default:!1},progressPercentage:{type:Number,default:null},currentProjectId:{type:String,default:null},currentProjectHasChecklistType:{type:Boolean,default:!1}},emits:["switch-language","mobile-reset","go-to-profile","logout"],setup(t){const{isDark:w,toggleTheme:p}=re();return q(()=>{}),F(()=>{}),(h,a)=>{const d=H;return t.showMobileMenu?(s(),l("div",Ze,[e("div",Je,[e("div",Qe,[e("button",{onClick:a[0]||(a[0]=(...i)=>O(p)&&O(p)(...i)),class:"w-full px-3 py-2 rounded-lg flex items-center justify-between bg-white hover:bg-gray-50 text-gray-700 transition-colors duration-200"},[a[5]||(a[5]=e("span",null,"Thème",-1)),n(d,{name:O(w)?"heroicons:sun":"heroicons:moon",class:"w-5 h-5 text-emerald-500"},null,8,["name"])]),a[7]||(a[7]=e("div",{class:"px-3 pt-2 text-xs text-gray-500"},"Langue",-1)),e("div",Xe,[e("button",{onClick:a[1]||(a[1]=i=>h.$emit("switch-language","fr")),class:"px-3 py-2 rounded-lg text-sm bg-white hover:bg-gray-50 text-gray-700 transition-colors duration-200"},"FR"),e("button",{onClick:a[2]||(a[2]=i=>h.$emit("switch-language","en")),class:"px-3 py-2 rounded-lg text-sm bg-white hover:bg-gray-50 text-gray-700 transition-colors duration-200"},"EN")]),t.currentProjectId&&t.currentProjectHasChecklistType?(s(),l("button",{key:0,onClick:a[3]||(a[3]=i=>h.$emit("mobile-reset")),class:"w-full px-3 py-2 rounded-lg flex items-center justify-between bg-white hover:bg-gray-50 text-gray-700 transition-colors duration-200"},[e("span",null,$(h.$t("common.reset")),1),n(d,{name:"heroicons:arrow-path",class:"w-5 h-5 text-gray-500"})])):C("",!0),e("div",et,[e("button",{onClick:a[4]||(a[4]=i=>h.$emit("logout")),class:"w-full px-3 py-2 rounded-lg flex items-center justify-between bg-white hover:bg-gray-50 text-red-600 transition-colors duration-200"},[a[6]||(a[6]=e("span",null,"Se déconnecter",-1)),n(d,{name:"heroicons:arrow-right-on-rectangle",class:"w-5 h-5 text-red-500"})])])])])])):C("",!0)}}},rt={class:"fixed top-0 left-0 right-0 z-50 border-b px-4 lg:px-4 p-4 backdrop-blur-sm transition-colors duration-300",style:{"background-color":"var(--header-bg)","border-color":"var(--header-border)"},role:"banner","aria-label":"En-tête de l'application"},ot={class:"flex items-center justify-between w-full"},st={__name:"DashboardAppHeader",props:{currentProjectId:{type:String,default:null},isSidebarCollapsed:{type:Boolean,default:!1}},emits:["toggle-sidebar"],setup(t,{emit:w}){const p=t,h=V?.()||null,a=D(()=>{try{return!!h?.currentProject?.checklistType}catch{return!1}}),{setLocale:d}=W(),{currentUser:i,signOut:m}=K();re();const f=j(!1),g=j(null),x=j(!1),u=j(!1),S=j(!1),U=j(null),k=D(()=>!!i.value),N=()=>{f.value=window.scrollY>20},r=o=>{g.value=o.detail.percentage},M=()=>{p.currentProjectId||(g.value=0)},P=()=>{S.value=!S.value},y=o=>{d(o),setTimeout(()=>{S.value=!1},100)},v=()=>{u.value=!u.value},T=o=>{u.value&&U.value&&(!U.value.$el&&!U.value.contains(o.target)||U.value.$el&&!U.value.$el.contains(o.target))&&(u.value=!1)},E=async()=>{try{await m(),u.value=!1,await z("/login")}catch{u.value=!1,await z("/login")}},c=()=>{S.value=!1};return le(),q(()=>{x.value=!0,window.addEventListener("scroll",N),window.addEventListener("progress-updated",r),ne().then(()=>{document.addEventListener("click",T),N(),M()})}),A(()=>p.currentProjectId,o=>{o||(g.value=0)}),F(()=>{window.removeEventListener("scroll",N),window.removeEventListener("progress-updated",r),document.removeEventListener("click",T)}),(o,I)=>(s(),l("header",rt,[e("div",ot,[n(xe,{"is-sidebar-collapsed":t.isSidebarCollapsed,onToggleSidebar:I[0]||(I[0]=b=>o.$emit("toggle-sidebar"))},null,8,["is-sidebar-collapsed"]),n(_e,{"progress-percentage":g.value,"current-project-id":t.currentProjectId},null,8,["progress-percentage","current-project-id"]),n(We,{ref_key:"userMenuRef",ref:U,"is-client":x.value,"show-mobile-menu":S.value,"show-user-menu":u.value,"user-logged-in":k.value,"current-user":O(i),onToggleMobileMenu:P,onToggleUserMenu:v,onLogout:E},null,8,["is-client","show-mobile-menu","show-user-menu","user-logged-in","current-user"])]),n(tt,{"show-mobile-menu":S.value,"progress-percentage":g.value,"current-project-id":t.currentProjectId,"current-project-has-checklist-type":a.value,onSwitchLanguage:y,onMobileReset:c,onLogout:E},null,8,["show-mobile-menu","progress-percentage","current-project-id","current-project-has-checklist-type"])]))}},at={class:"project-selector"},lt={class:"relative"},nt={class:"font-medium truncate"},it={key:0,class:"absolute z-50 mt-1 w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg border",style:{backgroundColor:"var(--bg-surface)",borderColor:"var(--bg-border)"},"data-cy":"project-dropdown"},ct={class:"py-1"},dt=["onClick"],ut={class:"truncate font-medium"},mt={key:0,class:"text-xs ml-2 px-2 py-1 rounded-full transition-colors duration-200",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)"}},pt={class:"border-t py-1",style:{borderColor:"var(--bg-border)"}},vt={class:"space-y-4"},ht=["disabled"],bt=["disabled"],gt={class:"text-gray-700 dark:text-gray-300"},yt={__name:"DashboardProjectSelector",props:{currentProjectId:{type:String,default:null}},emits:["project-changed","create-project"],setup(t,{emit:w}){const p=t,h=w,a=j(!1),d=j(!1),i=j(!1),m=j(""),f=j(""),g=j(!1),x=j(!1),u=V(),{user:S}=K(),U=D(()=>u.projects),k=D(()=>u.currentProject);A(()=>p.currentProjectId,c=>{c&&c!==u.currentProjectId&&u.setCurrentProject(c)},{immediate:!0}),A(()=>u.currentProjectId,c=>{c&&c!==p.currentProjectId&&h("project-changed",c)},{immediate:!0});const N=()=>{a.value=!a.value},r=async c=>{if(c)try{u.setCurrentProject(c),h("project-changed",c),a.value=!1,await new Promise(o=>setTimeout(o,100))}catch(o){console.error("Erreur lors de la sélection du projet:",o)}},M=()=>{d.value=!0},P=async()=>{if(m.value.trim()){if(!S.value?.uid){console.error("Utilisateur non connecté");return}try{x.value=!0;const c=await u.addProjectRemote(S.value.uid,{name:m.value.trim(),description:f.value.trim()});m.value="",f.value="",d.value=!1,await r(c.id),h("create-project",c)}catch(c){console.error("Erreur lors de la création du projet:",c)}finally{x.value=!1}}},y=()=>{k.value&&(i.value=!0)},v=async()=>{if(!(!k.value||!S.value?.uid))try{g.value=!0;const c=k.value.id;i.value=!1,u.removeProject(c),await u.removeProjectRemote(S.value.uid,c),U.value.length>0&&setTimeout(()=>{r(U.value[0].id)},100)}catch(c){console.error("Erreur lors de la suppression du projet:",c),i.value=!0}finally{g.value=!1}},T=c=>u.getProjectScores(c),E=c=>{a.value&&!c.target.closest(".project-selector")&&(a.value=!1)};return q(()=>{document.addEventListener("click",E),S.value?.uid&&u.initializeFirebaseSync(S.value.uid)}),F(()=>{document.removeEventListener("click",E)}),(c,o)=>{const I=H;return s(),l("div",at,[e("div",lt,[e("button",{onClick:N,class:"w-full flex items-center justify-between px-3 py-2 text-sm rounded-lg border transition-all duration-200 hover:shadow-sm focus:outline-none focus:ring-2 focus:ring-opacity-50",style:{backgroundColor:"var(--bg-surface)",borderColor:"var(--bg-border)",color:"var(--text-primary)",focusRingColor:"var(--accent-color)"},"data-cy":"project-selector"},[e("span",nt,$(k.value?k.value.name:"Sélectionner un projet"),1),n(I,{name:"heroicons:chevron-down",class:_(["w-4 h-4 transition-transform duration-200",{"rotate-180":a.value}]),style:{color:"var(--text-secondary)"},"aria-hidden":"true"},null,8,["class"])]),a.value?(s(),l("div",it,[e("div",ct,[(s(!0),l(Y,null,G(U.value,b=>(s(),l("button",{key:b.id,onClick:zt=>r(b.id),class:_(["w-full flex items-center justify-between px-3 py-2 text-sm transition-colors duration-200",{"border-l-2 opacity-80":b.id===k.value?.id,"hover:opacity-80":b.id!==k.value?.id}]),style:B({color:"var(--text-primary)",backgroundColor:b.id===k.value?.id?"var(--accent-color)":"transparent",borderLeftColor:b.id===k.value?.id?"var(--accent-color)":"transparent"}),"data-cy":"project-option"},[e("span",ut,$(b.name),1),T(b.id)?(s(),l("span",mt,$(Math.round(T(b.id).percentage))+"% ",1)):C("",!0)],14,dt))),128))]),e("div",pt,[e("button",{onClick:M,class:"w-full flex items-center px-3 py-2 text-sm transition-colors duration-200 hover:opacity-80 group",style:{color:"var(--text-primary)"},"data-cy":"add-project-button"},[n(I,{name:"heroicons:plus",class:"w-4 h-4 mr-2 transition-transform duration-200 group-hover:rotate-90",style:{color:"var(--accent-color)"},"aria-hidden":"true"}),o[8]||(o[8]=e("span",null,"Ajouter un projet",-1))]),k.value?(s(),l("button",{key:0,onClick:y,class:"w-full flex items-center px-3 py-2 text-sm transition-colors duration-200 hover:opacity-80 group",style:{color:"var(--text-secondary)"},"data-cy":"delete-project-button"},[n(I,{name:"heroicons:trash",class:"w-4 h-4 mr-2 transition-transform duration-200 group-hover:scale-110",style:{color:"var(--danger-color)"},"aria-hidden":"true"}),e("span",null,"Supprimer "+$(k.value.name),1)])):C("",!0)])])):C("",!0)]),n(te,{"is-open":d.value,"onUpdate:isOpen":o[3]||(o[3]=b=>d.value=b),title:"Créer un projet","close-on-backdrop":!x.value,"close-on-escape":!x.value,onClose:o[4]||(o[4]=b=>!x.value&&(d.value=!1))},{footer:R(()=>[e("button",{onClick:o[2]||(o[2]=b=>d.value=!1),disabled:x.value,class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed"}," Annuler ",8,ht),e("button",{onClick:P,disabled:!m.value.trim()||x.value,class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 bg-emerald-500 text-white hover:bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2","data-cy":"create-project-button"},[x.value?(s(),Q(I,{key:0,name:"heroicons:arrow-path",class:"w-4 h-4 animate-spin"})):(s(),Q(I,{key:1,name:"heroicons:plus",class:"w-4 h-4"})),e("span",null,$(x.value?"Création...":"Créer"),1)],8,bt)]),default:R(()=>[e("div",vt,[e("div",null,[o[9]||(o[9]=e("label",{for:"project-name",class:"block text-sm font-semibold mb-2 transition-colors duration-200",style:{color:"var(--text-primary)"}}," Nom du projet ",-1)),Z(e("input",{"onUpdate:modelValue":o[0]||(o[0]=b=>m.value=b),type:"text",class:"w-full px-3 py-2 text-sm rounded-lg border transition-colors duration-200",style:{backgroundColor:"var(--bg-surface)",borderColor:"var(--bg-border)",color:"var(--text-primary)"},placeholder:"Nom du projet","data-cy":"project-name-input"},null,512),[[J,m.value]])]),e("div",null,[o[10]||(o[10]=e("label",{for:"project-description",class:"block text-sm font-semibold mb-2 transition-colors duration-200",style:{color:"var(--text-primary)"}}," Description ",-1)),Z(e("textarea",{"onUpdate:modelValue":o[1]||(o[1]=b=>f.value=b),rows:"3",class:"w-full px-3 py-2 text-sm rounded-lg border resize-none transition-colors duration-200",style:{backgroundColor:"var(--bg-surface)",borderColor:"var(--bg-border)",color:"var(--text-primary)"},placeholder:"Description du projet (optionnel)","data-cy":"project-description-input"},null,512),[[J,f.value]])])])]),_:1},8,["is-open","close-on-backdrop","close-on-escape"]),n(te,{"is-open":i.value,"onUpdate:isOpen":o[6]||(o[6]=b=>i.value=b),title:"Êtes-vous sûr ?",onClose:o[7]||(o[7]=b=>i.value=!1)},{footer:R(()=>[e("button",{onClick:o[5]||(o[5]=b=>i.value=!1),class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}," Annuler "),e("button",{onClick:v,class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 bg-red-500 text-white hover:bg-red-600"}," Confirmer ")]),default:R(()=>[e("div",null,[e("p",gt,[o[11]||(o[11]=X(" Attention, cette action va supprimer définitivement le projet ",-1)),e("strong",null,$(k.value?.name),1),o[12]||(o[12]=X(". ",-1))])])]),_:1},8,["is-open"])])}}},ft=ie(yt,[["__scopeId","data-v-2341e620"]]),xt={key:0,class:"mb-6"},wt={class:"mb-6"},kt={key:0,class:"text-xs font-semibold mb-3 transition-colors duration-200 hidden sm:block tracking-wide",style:{color:"var(--text-primary)"}},Ct={class:"space-y-1",role:"navigation","aria-label":"Navigation générale"},jt={class:"space-y-1"},$t={key:0,class:"text-xs sm:text-sm font-medium truncate ml-2"},St={key:0,class:"ml-6 space-y-1"},Pt={key:0,class:"space-y-2"},_t={key:1,class:"space-y-1",role:"navigation","aria-label":"Navigation des catégories"},Mt=["onClick","onKeydown","aria-current","aria-label","title"],Tt={class:"text-xs font-medium truncate"},Ut={key:0,class:"text-xs sm:text-sm font-medium truncate ml-2"},Lt={key:0,class:"text-xs sm:text-sm font-medium truncate ml-2"},Et={key:0,class:"text-xs sm:text-sm font-medium truncate ml-2"},Dt={key:1},Nt={key:0,class:"text-center"},It={class:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center",style:{"background-color":"var(--bg-border)"}},Rt={class:"text-sm font-semibold mb-2 transition-colors duration-200",style:{color:"var(--text-primary)"}},Bt={class:"text-xs transition-colors duration-200",style:{color:"var(--text-secondary)"}},At={__name:"DashboardSidebar",props:{isSidebarCollapsed:{type:Boolean,default:!1}},emits:["toggle-sidebar","project-changed"],setup(t,{emit:w}){const p=w,h=j(!1),a=j(!1),d=j(null),i=V(),{t:m}=W(),f=D(()=>i.hasProjects);D(()=>i.currentProjectId);const g=D(()=>i.currentProject),x=pe("web-prelaunch");A(()=>g.value?.checklistType,r=>{r&&x.setChecklistType&&x.setChecklistType(r)},{immediate:!0});const u=D(()=>{try{if(!x||!g.value?.checklistType)return[];const{getAllCategories:r,getCategoryData:M}=x;return r().map(y=>{try{const v=M(y),T=m(`categories.${y}.name`),E=S(y);return{id:y,name:T,icon:E}}catch{return{id:y,name:`Catégorie ${y}`,icon:"heroicons:document-text"}}})}catch{return[]}}),S=r=>({seo:"heroicons:magnifying-glass",accessibilite:"heroicons:heart",performance:"heroicons:bolt","eco-conception":"heroicons:globe-alt","responsive-ux":"heroicons:device-phone-mobile",securite:"heroicons:shield-check",analytics:"heroicons:chart-bar","reseau-chiffrement":"heroicons:lock-closed","authentification-acces":"heroicons:key","protection-attaques":"heroicons:shield-exclamation","fichiers-donnees":"heroicons:document-check","maintenance-surveillance":"heroicons:eye","app-store":"heroicons:device-phone-mobile","play-store":"heroicons:device-phone-mobile",technical:"heroicons:cog",legal:"heroicons:scale"})[r]||"heroicons:document-text",U=async r=>{try{a.value=!0,i.setCurrentProject(r),d.value=null,p("project-changed",r)}catch{}finally{setTimeout(()=>{a.value=!1},300)}},k=r=>{try{{const M=document.getElementById(`category-${r}`);M&&(d.value=r,window.dispatchEvent(new CustomEvent("open-category",{detail:{categoryId:r}})),setTimeout(()=>{try{const v=M.offsetTop-80-20;window.scrollTo({top:Math.max(0,v),behavior:"smooth"})}catch{}},300))}}catch{}},N=()=>{try{if(u.value&&Array.isArray(u.value)){const r=window.scrollY,M=window.innerHeight,P=80;let y=null,v=1/0;u.value.forEach(T=>{try{const E=document.getElementById(`category-${T.id}`);if(E){const c=E.getBoundingClientRect(),o=Math.abs(c.top-P);o<v&&(v=o,y=T.id)}}catch{}}),y&&y!==d.value&&(d.value=y)}}catch{}};return q(()=>{h.value=!0,window.addEventListener("scroll",N)}),F(()=>{window.removeEventListener("scroll",N)}),(r,M)=>{const P=H,y=me;return s(),l("aside",{class:_(["fixed left-0 top-[77px] border-r transition-all duration-500 ease-in-out h-[calc(100vh-77px)] flex flex-col z-10 shadow-lg",t.isSidebarCollapsed?"w-14":"w-72"]),style:{"border-color":"var(--bg-border)","background-color":"var(--bg-surface)"},role:"navigation","aria-label":"Navigation des vérifications"},[e("div",{class:_(["flex-1 min-h-0 overflow-auto",t.isSidebarCollapsed?"px-2 pb-0 pt-4":"p-4 pb-0 pt-4"])},[t.isSidebarCollapsed?C("",!0):(s(),l("div",xt,[n(ft,{onProjectChanged:U})])),e("div",wt,[t.isSidebarCollapsed?C("",!0):(s(),l("h3",kt," Navigation ")),e("nav",Ct,[e("div",jt,[n(y,{to:"/dashboard",class:_(["rounded-xl transition-all duration-200 flex items-center",[t.isSidebarCollapsed?"w-10 h-10 mx-auto justify-center":"w-full text-left px-2 py-2 sm:px-3 sm:py-2"]]),style:B({backgroundColor:(r._.provides[L]||r.$route).path==="/dashboard"?"var(--bg-border)":"transparent",color:"var(--text-primary)"}),"aria-current":(r._.provides[L]||r.$route).path==="/dashboard"?"page":void 0,title:t.isSidebarCollapsed?"Tableau de bord":void 0},{default:R(()=>[n(P,{name:"heroicons:home",class:_(["flex-shrink-0",t.isSidebarCollapsed?"w-5 h-5":"w-5 h-5 mr-0.5"]),style:{color:"var(--text-primary)"},"aria-hidden":"true"},null,8,["class"]),t.isSidebarCollapsed?C("",!0):(s(),l("span",$t,"Tableau de bord"))]),_:1},8,["class","style","aria-current","title"]),h.value&&f.value&&g.value?.checklistType&&(r._.provides[L]||r.$route).path==="/dashboard"&&!t.isSidebarCollapsed?(s(),l("div",St,[a.value?(s(),l("div",Pt,[(s(),l(Y,null,G(5,v=>e("div",{key:`skeleton-category-${v}`,class:"rounded-xl h-8 animate-pulse",style:{"background-color":"var(--bg-border)"}})),64))])):(s(),l("nav",_t,[(s(!0),l(Y,null,G(u.value,v=>(s(),l("button",{key:v.id,onClick:T=>k(v.id),onKeydown:[ee(T=>k(v.id),["enter"]),ee(ce(T=>k(v.id),["prevent"]),["space"])],class:"rounded-lg transition-all duration-200 flex items-center w-full text-left px-2 py-1.5 text-xs",style:B({backgroundColor:d.value===v.id?"var(--bg-border)":"transparent",color:"var(--text-primary)",borderColor:"transparent"}),"aria-current":d.value===v.id?"location":void 0,"aria-label":r.$t("common.goToCategory",{name:v.name}),title:r.$t("common.goToCategory",{name:v.name}),role:"menuitem",tabindex:"0"},[n(P,{name:v.icon,class:"w-4 h-4 mr-2 flex-shrink-0",style:{color:"var(--text-primary)"},"aria-hidden":"true"},null,8,["name"]),e("span",Tt,$(v.name),1)],44,Mt))),128))]))])):C("",!0)]),n(y,{to:"/profile",class:_(["rounded-xl transition-all duration-200 flex items-center",[t.isSidebarCollapsed?"w-10 h-10 mx-auto justify-center":"w-full text-left px-2 py-2 sm:px-3 sm:py-2"]]),style:B({backgroundColor:(r._.provides[L]||r.$route).path==="/profile"?"var(--bg-border)":"transparent",color:"var(--text-primary)"}),"aria-current":(r._.provides[L]||r.$route).path==="/profile"?"page":void 0,title:t.isSidebarCollapsed?"Mon profil":void 0},{default:R(()=>[n(P,{name:"heroicons:user",class:_(["flex-shrink-0",t.isSidebarCollapsed?"w-5 h-5":"w-5 h-5 mr-0.5"]),style:{color:"var(--text-primary)"},"aria-hidden":"true"},null,8,["class"]),t.isSidebarCollapsed?C("",!0):(s(),l("span",Ut,"Mon profil"))]),_:1},8,["class","style","aria-current","title"]),n(y,{to:"/settings",class:_(["rounded-xl transition-all duration-200 flex items-center",[t.isSidebarCollapsed?"w-10 h-10 mx-auto justify-center":"w-full text-left px-2 py-2 sm:px-3 sm:py-2"]]),style:B({backgroundColor:(r._.provides[L]||r.$route).path==="/settings"?"var(--bg-border)":"transparent",color:"var(--text-primary)"}),"aria-current":(r._.provides[L]||r.$route).path==="/settings"?"page":void 0,title:t.isSidebarCollapsed?"Paramètres":void 0},{default:R(()=>[n(P,{name:"heroicons:cog-6-tooth",class:_(["flex-shrink-0",t.isSidebarCollapsed?"w-5 h-5":"w-5 h-5 mr-0.5"]),style:{color:"var(--text-primary)"},"aria-hidden":"true"},null,8,["class"]),t.isSidebarCollapsed?C("",!0):(s(),l("span",Lt,"Paramètres"))]),_:1},8,["class","style","aria-current","title"]),n(y,{to:"/help",class:_(["rounded-xl transition-all duration-200 flex items-center",[t.isSidebarCollapsed?"w-10 h-10 mx-auto justify-center":"w-full text-left px-2 py-2 sm:px-3 sm:py-2"]]),style:B({backgroundColor:(r._.provides[L]||r.$route).path==="/help"?"var(--bg-border)":"transparent",color:"var(--text-primary)"}),"aria-current":(r._.provides[L]||r.$route).path==="/help"?"page":void 0,title:t.isSidebarCollapsed?"Aide":void 0},{default:R(()=>[n(P,{name:"heroicons:question-mark-circle",class:_(["flex-shrink-0",t.isSidebarCollapsed?"w-5 h-5":"w-5 h-5 mr-0.5"]),style:{color:"var(--text-primary)"},"aria-hidden":"true"},null,8,["class"]),t.isSidebarCollapsed?C("",!0):(s(),l("span",Et,"Aide & Support"))]),_:1},8,["class","style","aria-current","title"])])]),h.value&&f.value&&g.value?.checklistType&&(r._.provides[L]||r.$route).path==="/dashboard"?(s(),l("div",Dt,[h.value&&!t.isSidebarCollapsed&&(!f.value||!g.value?.checklistType)&&(r._.provides[L]||r.$route).path==="/dashboard"?(s(),l("div",Nt,[e("div",It,[n(P,{name:"heroicons:folder",class:"w-8 h-8",style:{color:"var(--accent-primary)"},"aria-hidden":"true"})]),e("h3",Rt,$(f.value?"Choisir un type de checklist":r.$t("sidebar.welcome")),1),e("p",Bt,$(f.value?"Sélectionnez le type de checklist qui correspond à votre projet":r.$t("sidebar.createProjectMessage")),1)])):C("",!0)])):C("",!0)],2)],2)}}},Ht=oe(ae),Ot={class:"pt-[77px] flex items-stretch overflow-hidden"},Jt={__name:"dashboard",setup(t){const w=V(),{currentUser:p,ready:h}=K(),a=D(()=>w.currentProjectId);A([p,h],([g,x])=>{x&&g&&!w.isSynced&&w.subscribeUserProjects(g.uid)},{immediate:!0});const d=()=>{window.dispatchEvent(new CustomEvent("reset-checklist-progress"))},i=g=>{},m=j(!1),f=()=>{m.value=!m.value};return(g,x)=>{const u=Ht;return s(),l("div",null,[n(u),n(st,{"current-project-id":a.value,"is-sidebar-collapsed":m.value,onResetProgress:d,onToggleSidebar:f},null,8,["current-project-id","is-sidebar-collapsed"]),e("div",Ot,[n(At,{"is-sidebar-collapsed":m.value,onToggleSidebar:f,onProjectChanged:i},null,8,["is-sidebar-collapsed"]),e("main",{class:_(["w-full min-w-0 min-h-0 overflow-auto bg-[var(--bg-primary)] transition-all duration-500 ease-in-out",m.value?"ml-14":"ml-72"]),style:{height:"calc(100vh - 77px)"},role:"main","aria-label":"Contenu principal des vérifications"},[de(g.$slots,"default")],2)]),n(se)])}}};export{Jt as default};
