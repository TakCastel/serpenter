import{c as le,_ as ne,a as ie}from"./CDJxWnmB.js";import{u as F}from"./BSTblzJG.js";import Y from"./CCn08sVd.js";import{$ as G,e as E,c as a,o as s,a as e,b as n,g as T,t as h,d as w,ai as D,n as q,f as W,Z as X,a0 as x,r as j,C as ce,a6 as se,w as Z,af as de,a2 as ue,aj as R,V,ag as Q,ah as ee,a1 as A,h as H,W as te,X as re,j as me}from"./-Ay7-MNe.js";import{_ as pe,u as ae}from"./C-5UWYdn.js";import{u as J}from"./C6gp9-_Z.js";import{_ as he}from"./xfpmlWL8.js";import{M as oe,u as ve}from"./MudozFyT.js";const be={class:"flex items-center space-x-4"},ge=["title","aria-label"],ye={class:"flex items-center space-x-3"},fe={class:"flex flex-col"},xe={class:"font-bold tracking-tight text-xl text-emerald-500"},we={class:"text-xs text-gray-600"},ke={__name:"DashboardHeaderLeftSection",props:{isSidebarCollapsed:{type:Boolean,default:!1}},emits:["toggle-sidebar"],setup(t){const{t:k,te:o,locale:v}=G({useScope:"global"}),l=E(()=>o&&o("app.title")?k("app.title"):"Serpenter"),u=E(()=>o&&o("app.subtitle")?k("app.subtitle"):(v?.value==="fr","Check, Check. Go."));return(i,b)=>{const f=Y;return s(),a("div",be,[e("button",{onClick:b[0]||(b[0]=d=>i.$emit("toggle-sidebar")),class:"w-10 h-10 rounded-lg flex items-center justify-center transition-all duration-200 hover:scale-105 hover:shadow-md",style:{backgroundColor:"var(--button-bg)",borderColor:"var(--button-border)",color:"var(--text-primary)"},title:t.isSidebarCollapsed?"Ouvrir la barre latérale":"Réduire la barre latérale","aria-label":t.isSidebarCollapsed?"Ouvrir la barre latérale":"Réduire la barre latérale"},[n(f,{name:t.isSidebarCollapsed?"heroicons:bars-3":"heroicons:x-mark",class:T(["w-5 h-5 transition-transform duration-300",{"rotate-180":!t.isSidebarCollapsed}]),style:{color:"var(--text-primary)"}},null,8,["name","class"])],8,ge),e("div",ye,[n(f,{name:"fluent-emoji:snake",class:"w-8 h-8 sm:w-10 sm:h-10","aria-hidden":"true"}),e("div",fe,[e("h1",xe,h(l.value),1),e("span",we,h(u.value),1)])])])}}},Ce={class:"hidden lg:flex items-center justify-center flex-1 max-w-md mx-8"},$e={key:0,class:"flex items-center space-x-3"},_e={class:"relative w-12 h-12"},je={class:"w-12 h-12 transform -rotate-90",viewBox:"0 0 36 36"},Pe=["stroke-dasharray"],Se={class:"absolute inset-0 flex items-center justify-center"},Me={class:"text-xs font-semibold text-gray-700 transition-colors duration-200"},Te={__name:"DashboardHeaderCenterSection",props:{progressPercentage:{type:Number,default:null},currentProjectId:{type:String,default:null}},setup(t){return(k,o)=>(s(),a("div",Ce,[t.progressPercentage!==null&&t.currentProjectId&&(k._.provides[D]||k.$route).path==="/dashboard"?(s(),a("div",$e,[e("div",_e,[(s(),a("svg",je,[o[0]||(o[0]=e("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#e5e7eb","stroke-width":"2","stroke-linecap":"round"},null,-1)),e("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#059669","stroke-width":"2","stroke-linecap":"round","stroke-dasharray":`${t.progressPercentage*1.131}, 100`,class:"transition-all duration-500 ease-out"},null,8,Pe)])),e("div",Se,[e("span",Me,h(Math.round(t.progressPercentage))+"% ",1)])]),o[1]||(o[1]=e("div",{class:"text-sm text-gray-600"},[e("div",{class:"font-medium"},"Progression du projet"),e("div",{class:"text-xs text-gray-500"},"terminé")],-1))])):w("",!0)]))}},Ue={class:"flex items-center space-x-3",role:"toolbar","aria-label":"Actions de l'application"},Le=["aria-expanded"],Ee={key:0,class:"relative"},Ie=["aria-expanded"],De={class:"w-8 h-8 rounded-full overflow-hidden ring-2 ring-emerald-200 hover:ring-emerald-300 transition-all duration-200"},Ne=["src","alt"],Re={key:1,class:"w-full h-full bg-gradient-to-br from-emerald-400 to-emerald-600 flex items-center justify-center"},Be={class:"hidden md:block text-left"},He={class:"text-sm font-semibold",style:{color:"var(--text-primary)"}},Ke={class:"text-xs",style:{color:"var(--text-secondary)"}},Oe={key:0,class:"absolute top-full right-0 mt-3 w-72 rounded-2xl border shadow-2xl z-50 backdrop-blur-sm",style:{backgroundColor:"var(--bg-surface)",borderColor:"var(--bg-border)"},role:"menu","aria-label":"Menu utilisateur"},Ae={class:"px-6 py-6 text-center border-b",style:{borderColor:"var(--bg-border)"}},ze={class:"flex flex-col items-center space-y-3"},Ve={class:"w-16 h-16 rounded-full overflow-hidden ring-4 ring-emerald-100 hover:ring-emerald-200 transition-all duration-200"},qe=["src","alt"],Ye={key:1,class:"w-full h-full bg-gradient-to-br from-emerald-400 to-emerald-600 flex items-center justify-center"},Fe={class:"text-lg font-bold",style:{color:"var(--text-primary)"}},Ge={class:"text-sm",style:{color:"var(--text-secondary)"}},We={class:"p-4 space-y-3"},Xe={class:"p-4"},Ze={__name:"DashboardHeaderRightSection",props:{isClient:{type:Boolean,default:!1},showMobileMenu:{type:Boolean,default:!1},showUserMenu:{type:Boolean,default:!1},userLoggedIn:{type:Boolean,default:!1},currentUser:{type:Object,default:null}},emits:["toggle-mobile-menu","toggle-user-menu","logout"],setup(t,{emit:k}){const{signOut:o}=J(),v=k,l=async()=>{try{await o(),v("logout"),await q("/login")}catch{await q("/login")}};return(u,i)=>{const b=Y;return s(),a("div",Ue,[e("button",{onClick:i[0]||(i[0]=f=>u.$emit("toggle-mobile-menu")),class:"sm:hidden w-10 h-10 rounded-lg flex items-center justify-center transition-colors duration-200",style:{backgroundColor:"var(--button-bg)",borderColor:"var(--button-border)",color:"var(--text-primary)"},"aria-expanded":t.showMobileMenu,"aria-label":"Ouvrir le menu mobile"},[n(b,{name:"heroicons:ellipsis-vertical",class:"w-5 h-5",style:{color:"var(--text-primary)"}})],8,Le),t.userLoggedIn?(s(),a("div",Ee,[e("button",{onClick:i[1]||(i[1]=f=>u.$emit("toggle-user-menu")),class:"flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors duration-200 hover:bg-opacity-80",style:{backgroundColor:"var(--button-bg)",color:"var(--text-primary)"},"aria-expanded":t.showUserMenu,"aria-label":"Menu utilisateur"},[e("div",De,[t.currentUser?.photoURL?(s(),a("img",{key:0,src:t.currentUser.photoURL,alt:t.currentUser?.displayName||"Avatar",class:"w-full h-full object-cover"},null,8,Ne)):(s(),a("div",Re,[n(b,{name:"heroicons:user",class:"w-4 h-4 text-white"})]))]),e("div",Be,[e("div",He,h(t.currentUser?.displayName||t.currentUser?.email?.split("@")[0]||"Utilisateur"),1),e("div",Ke,h(t.currentUser?.email||"Membre actif"),1)]),n(b,{name:"heroicons:chevron-down",class:T(["w-4 h-4 transition-transform duration-200",{"rotate-180":t.showUserMenu}]),style:{color:"var(--text-muted)"}},null,8,["class"])],8,Ie),t.showUserMenu?(s(),a("div",Oe,[e("div",Ae,[e("div",ze,[e("div",Ve,[t.currentUser?.photoURL?(s(),a("img",{key:0,src:t.currentUser.photoURL,alt:t.currentUser?.displayName||"Avatar",class:"w-full h-full object-cover"},null,8,qe)):(s(),a("div",Ye,[n(b,{name:"heroicons:user",class:"w-8 h-8 text-white"})]))]),e("div",null,[e("div",Fe,h(t.currentUser?.displayName||t.currentUser?.email?.split("@")[0]||"Utilisateur"),1),e("div",Ge,h(t.currentUser?.email||"Membre actif"),1)])])]),e("div",We,[n(pe,{size:"sm",context:"dropdown"})]),i[3]||(i[3]=e("div",{class:"border-t mx-4",style:{borderColor:"var(--bg-border)"}},null,-1)),e("div",Xe,[e("button",{onClick:l,class:"w-full px-4 py-3 text-left text-sm transition-all duration-200 hover:bg-opacity-90 rounded-xl bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:hover:bg-red-900/30 text-red-600 flex items-center justify-center space-x-3 font-medium"},[n(b,{name:"heroicons:arrow-right-on-rectangle",class:"w-5 h-5 text-red-500"}),i[2]||(i[2]=e("span",null,"Se déconnecter",-1))])])])):w("",!0)])):w("",!0)])}}},Je={key:0,class:"sm:hidden mt-3 px-1",role:"menu","aria-label":"Menu mobile"},Qe={class:"rounded-lg border border-gray-200 bg-white shadow-lg"},et={class:"p-2 space-y-1"},tt={class:"grid grid-cols-2 gap-2 px-2"},rt={class:"border-t border-gray-100 pt-2"},ot={__name:"DashboardHeaderMobileMenu",props:{showMobileMenu:{type:Boolean,default:!1},progressPercentage:{type:Number,default:null},currentProjectId:{type:String,default:null},currentProjectHasChecklistType:{type:Boolean,default:!1}},emits:["switch-language","mobile-reset","go-to-profile","logout"],setup(t){const{isDark:k,toggleTheme:o}=ae();return W(()=>{}),X(()=>{}),(v,l)=>{const u=Y;return t.showMobileMenu?(s(),a("div",Je,[e("div",Qe,[e("div",et,[e("button",{onClick:l[0]||(l[0]=(...i)=>x(o)&&x(o)(...i)),class:"w-full px-3 py-2 rounded-lg flex items-center justify-between bg-white hover:bg-gray-50 text-gray-700 transition-colors duration-200"},[l[5]||(l[5]=e("span",null,"Thème",-1)),n(u,{name:x(k)?"heroicons:sun":"heroicons:moon",class:"w-5 h-5 text-emerald-500"},null,8,["name"])]),l[7]||(l[7]=e("div",{class:"px-3 pt-2 text-xs text-gray-500"},"Langue",-1)),e("div",tt,[e("button",{onClick:l[1]||(l[1]=i=>v.$emit("switch-language","fr")),class:"px-3 py-2 rounded-lg text-sm bg-white hover:bg-gray-50 text-gray-700 transition-colors duration-200"},"FR"),e("button",{onClick:l[2]||(l[2]=i=>v.$emit("switch-language","en")),class:"px-3 py-2 rounded-lg text-sm bg-white hover:bg-gray-50 text-gray-700 transition-colors duration-200"},"EN")]),t.currentProjectId&&t.currentProjectHasChecklistType?(s(),a("button",{key:0,onClick:l[3]||(l[3]=i=>v.$emit("mobile-reset")),class:"w-full px-3 py-2 rounded-lg flex items-center justify-between bg-white hover:bg-gray-50 text-gray-700 transition-colors duration-200"},[e("span",null,h(v.$t("common.reset")),1),n(u,{name:"heroicons:arrow-path",class:"w-5 h-5 text-gray-500"})])):w("",!0),e("div",rt,[e("button",{onClick:l[4]||(l[4]=i=>v.$emit("logout")),class:"w-full px-3 py-2 rounded-lg flex items-center justify-between bg-white hover:bg-gray-50 text-red-600 transition-colors duration-200"},[l[6]||(l[6]=e("span",null,"Se déconnecter",-1)),n(u,{name:"heroicons:arrow-right-on-rectangle",class:"w-5 h-5 text-red-500"})])])])])])):w("",!0)}}},st={class:"fixed top-0 left-0 right-0 z-50 border-b px-4 lg:px-4 p-4 backdrop-blur-sm transition-colors duration-300",style:{"background-color":"var(--header-bg)","border-color":"var(--header-border)"},role:"banner","aria-label":"En-tête de l'application"},at={class:"flex items-center justify-between w-full"},lt={__name:"DashboardAppHeader",props:{currentProjectId:{type:String,default:null},isSidebarCollapsed:{type:Boolean,default:!1}},emits:["toggle-sidebar"],setup(t,{emit:k}){const o=t,v=F?.()||null,l=E(()=>{try{return!!v?.currentProject?.checklistType}catch{return!1}}),{setLocale:u}=G(),{currentUser:i,signOut:b}=J();ae();const f=j(!1),d=j(null),U=j(!1),m=j(!1),N=j(!1),P=j(null),L=E(()=>!!i.value),B=()=>{f.value=window.scrollY>20},r=C=>{d.value=C.detail.percentage},S=()=>{o.currentProjectId||(d.value=0)},$=()=>{N.value=!N.value},g=C=>{u(C),setTimeout(()=>{N.value=!1},100)},p=()=>{m.value=!m.value},M=C=>{m.value&&P.value&&(!P.value.$el&&!P.value.contains(C.target)||P.value.$el&&!P.value.$el.contains(C.target))&&(m.value=!1)},I=async()=>{try{await b(),m.value=!1,await q("/login")}catch{m.value=!1,await q("/login")}},z=()=>{N.value=!1};return ce(),W(()=>{U.value=!0,window.addEventListener("scroll",B),window.addEventListener("progress-updated",r),se().then(()=>{document.addEventListener("click",M),B(),S()})}),Z(()=>o.currentProjectId,C=>{C||(d.value=0)}),X(()=>{window.removeEventListener("scroll",B),window.removeEventListener("progress-updated",r),document.removeEventListener("click",M)}),(C,_)=>(s(),a("header",st,[e("div",at,[n(ke,{"is-sidebar-collapsed":t.isSidebarCollapsed,onToggleSidebar:_[0]||(_[0]=y=>C.$emit("toggle-sidebar"))},null,8,["is-sidebar-collapsed"]),n(Te,{"progress-percentage":d.value,"current-project-id":t.currentProjectId},null,8,["progress-percentage","current-project-id"]),n(Ze,{ref_key:"userMenuRef",ref:P,"is-client":U.value,"show-mobile-menu":N.value,"show-user-menu":m.value,"user-logged-in":L.value,"current-user":x(i),onToggleMobileMenu:$,onToggleUserMenu:p,onLogout:I},null,8,["is-client","show-mobile-menu","show-user-menu","user-logged-in","current-user"])]),n(ot,{"show-mobile-menu":N.value,"progress-percentage":d.value,"current-project-id":t.currentProjectId,"current-project-has-checklist-type":l.value,onSwitchLanguage:g,onMobileReset:z,onLogout:I},null,8,["show-mobile-menu","progress-percentage","current-project-id","current-project-has-checklist-type"])]))}},nt={class:"relative"},it={__name:"CommonSkeletonProjectSelector",setup(t){return(k,o)=>(s(),a("div",nt,o[0]||(o[0]=[de('<div class="w-full flex items-center justify-between px-3 py-2 rounded-lg border animate-pulse" style="background-color:var(--bg-surface);border-color:var(--bg-border);"><div class="flex items-center space-x-2"><div class="w-4 h-4 rounded bg-gray-300 dark:bg-gray-600 animate-pulse"></div><div class="h-4 w-32 bg-gray-300 dark:bg-gray-600 rounded animate-pulse"></div></div><div class="w-4 h-4 rounded bg-gray-300 dark:bg-gray-600 animate-pulse"></div></div>',1)])))}},ct={class:"relative"},dt=["onKeydown","aria-label","aria-expanded","disabled"],ut={class:"flex items-center space-x-3 min-w-0 flex-1"},mt={class:"text-sm font-medium truncate"},pt={key:0,class:"ml-2"},ht=["aria-label"],vt={key:0,class:"py-2"},bt=["onClick","onKeydown","aria-selected","onMouseleave"],gt={class:"flex items-center space-x-3 min-w-0 flex-1"},yt={class:"flex-1 min-w-0"},ft={class:"font-medium truncate"},xt={class:"text-xs opacity-70 truncate"},wt={class:"flex items-center space-x-3 ml-3 flex-shrink-0"},kt={class:"text-xs text-right"},Ct={class:"font-medium",style:{color:"var(--accent-primary)"}},$t={key:0,class:"flex items-center"},_t={key:1,class:"border-t my-2",style:{"border-color":"var(--bg-border)"}},jt={class:"py-2"},Pt=["onKeydown"],St={class:"truncate"},Mt=["onKeydown"],Tt={class:"truncate"},Ut={class:"space-y-4"},Lt={class:"block text-sm font-semibold mb-2",style:{color:"var(--text-primary)"}},Et=["placeholder"],It={class:"block text-sm font-semibold mb-2",style:{color:"var(--text-primary)"}},Dt=["placeholder"],Nt=["disabled"],Rt={class:"text-sm",style:{color:"var(--text-secondary)"}},Bt={__name:"DashboardProjectSelector",emits:["project-changed"],setup(t,{emit:k}){const{t:o}=G(),v=k,l=F(),{currentUser:u}=J(),i=j(!1),b=j(!1),f=j(!1),d=j(!1),U=j(!1),m=j({name:"",description:""}),N=E(()=>l.currentProject),P=E(()=>l.projects),L=E(()=>l.currentProjectId),B=E(()=>U.value&&N.value?.name||o("projects.selectProject")),r=()=>{i.value=!i.value},S=async _=>{try{d.value=!0,i.value=!1,l.setCurrentProject(_),v("project-changed",_),await se(),window.dispatchEvent(new CustomEvent("project-checklist-changed",{detail:{projectId:_,checklistType:l.currentProject?.checklistType}}))}catch(y){console.error("Erreur lors de la sélection du projet:",y)}finally{setTimeout(()=>{d.value=!1},100)}},$=()=>{b.value=!0,i.value=!1,m.value={name:"",description:""}},g=()=>{b.value=!1},p=async()=>{if(!(!m.value.name.trim()||!u.value))try{const _=await l.addProjectRemote(u.value.uid,{name:m.value.name.trim(),description:m.value.description.trim()});l.setCurrentProject(_.id),v("project-changed",_.id),g(),_.checklistType||await q("/select-checklist")}catch(_){console.error("Erreur lors de la création du projet:",_)}},M=()=>{f.value=!0,i.value=!1},I=()=>{f.value=!1},z=async()=>{!u.value||!L.value||(await l.deleteProjectRemote(u.value.uid,L.value),P.value.length===0?v("project-changed",null):v("project-changed",l.currentProjectId),I())},C=_=>{_.target.closest(".relative")||(i.value=!1)};return Z(P,_=>{_.length>0&&d.value&&(d.value=!1)},{immediate:!0}),W(()=>{U.value=!0,document.addEventListener("click",C)}),X(()=>{document.removeEventListener("click",C)}),(_,y)=>{const K=Y;return s(),a("div",ct,[d.value?(s(),ue(it,{key:0})):(s(),a("button",{key:1,onClick:r,onKeydown:[R(r,["enter"]),R(V(r,["prevent"]),["space"])],class:"w-full flex items-center justify-between px-4 py-3 rounded-xl border transition-all duration-200 hover:bg-opacity-80",style:{"background-color":"var(--bg-primary)","border-color":"var(--bg-border)",color:"var(--text-primary)"},"aria-label":x(o)("projects.selectProject"),"aria-expanded":i.value,"aria-haspopup":!0,role:"combobox",tabindex:"0",disabled:d.value},[e("div",ut,[n(K,{name:"heroicons:folder",class:"w-4 h-4 flex-shrink-0",style:{color:"var(--accent-primary)"},"aria-hidden":"true"}),e("span",mt,h(B.value),1),d.value?(s(),a("div",pt,y[9]||(y[9]=[e("div",{class:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"},null,-1)]))):w("",!0)]),n(K,{name:"heroicons:chevron-down",class:T(["w-4 h-4 transition-transform duration-200 flex-shrink-0 ml-2",{"rotate-180":i.value}]),style:{color:"var(--text-secondary)"},"aria-hidden":"true"},null,8,["class"])],40,dt)),i.value?(s(),a("div",{key:2,class:"absolute top-full left-0 right-0 mt-3 rounded-xl border z-50",style:{"background-color":"var(--bg-surface)","border-color":"var(--bg-border)"},role:"listbox","aria-label":x(o)("projects.projectList")},[P.value.length>0?(s(),a("div",vt,[(s(!0),a(Q,null,ee(P.value,c=>(s(),a("button",{key:c.id,onClick:O=>S(c.id),onKeydown:[R(O=>S(c.id),["enter"]),R(V(O=>S(c.id),["prevent"]),["space"])],class:"w-full text-left px-4 py-3 text-sm transition-all duration-200 flex items-center justify-between",style:A({color:c.id===L.value?"var(--accent-primary)":"var(--text-primary)",backgroundColor:c.id===L.value?"var(--bg-border)":"transparent"}),"aria-selected":c.id===L.value,role:"option",tabindex:"0",onMouseenter:y[0]||(y[0]=O=>O.target.style.backgroundColor="var(--bg-border)"),onMouseleave:O=>O.target.style.backgroundColor=c.id===L.value?"var(--bg-border)":"transparent"},[e("div",gt,[n(K,{name:"heroicons:folder",class:"w-4 h-4 flex-shrink-0","aria-hidden":"true"}),e("div",yt,[e("div",ft,h(c.name),1),e("div",xt,h(c.description),1)])]),e("div",wt,[e("div",kt,[e("div",Ct,h(x(l).getProjectScores(c.id).percentage)+"% ",1)]),c.id===L.value?(s(),a("div",$t,[n(K,{name:"heroicons:check",class:"w-4 h-4",style:{color:"var(--accent-primary)"},"aria-hidden":"true"})])):w("",!0)])],44,bt))),128))])):w("",!0),P.value.length>0?(s(),a("div",_t)):w("",!0),e("div",jt,[e("button",{onClick:$,onKeydown:[R($,["enter"]),R(V($,["prevent"]),["space"])],class:"w-full text-left px-4 py-3 text-sm transition-all duration-200 flex items-center space-x-3",style:{color:"var(--text-primary)"},role:"menuitem",tabindex:"0",onMouseenter:y[1]||(y[1]=c=>c.target.style.backgroundColor="var(--bg-border)"),onMouseleave:y[2]||(y[2]=c=>c.target.style.backgroundColor="transparent")},[n(K,{name:"heroicons:plus",class:"w-4 h-4 flex-shrink-0",style:{color:"var(--accent-primary)"},"aria-hidden":"true"}),e("span",St,h(x(o)("projects.createNew")),1)],40,Pt),P.value.length>0?(s(),a("button",{key:0,onClick:M,onKeydown:[R(M,["enter"]),R(V(M,["prevent"]),["space"])],class:"w-full text-left px-4 py-3 text-sm transition-all duration-200 flex items-center space-x-3",style:{color:"var(--text-danger)"},role:"menuitem",tabindex:"0",onMouseenter:y[3]||(y[3]=c=>c.target.style.backgroundColor="var(--bg-border)"),onMouseleave:y[4]||(y[4]=c=>c.target.style.backgroundColor="transparent")},[n(K,{name:"heroicons:trash",class:"w-4 h-4 flex-shrink-0",style:{color:"var(--text-danger)"},"aria-hidden":"true"}),e("span",Tt,h(x(o)("projects.deleteCurrent")),1)],40,Mt)):w("",!0)])],8,ht)):w("",!0),n(oe,{"is-open":b.value,"onUpdate:isOpen":y[7]||(y[7]=c=>b.value=c),title:x(o)("projects.createTitle"),onClose:g},{footer:H(()=>[e("button",{onClick:g,class:"px-4 py-2 rounded-lg font-medium transition-all duration-200",style:{"background-color":"var(--bg-primary)",border:"1px solid var(--bg-border)",color:"var(--text-primary)"}},h(x(o)("common.cancel")),1),e("button",{onClick:p,class:"px-4 py-2 rounded-lg font-medium transition-all duration-200",style:{"background-color":"var(--accent-primary)",color:"white"},disabled:!m.value.name.trim()},h(x(o)("projects.create")),9,Nt)]),default:H(()=>[e("div",Ut,[e("div",null,[e("label",Lt,h(x(o)("projects.name")),1),te(e("input",{"onUpdate:modelValue":y[5]||(y[5]=c=>m.value.name=c),type:"text",class:"input w-full",placeholder:x(o)("projects.namePlaceholder"),onKeydown:R(p,["enter"])},null,40,Et),[[re,m.value.name]])]),e("div",null,[e("label",It,h(x(o)("projects.description")),1),te(e("textarea",{"onUpdate:modelValue":y[6]||(y[6]=c=>m.value.description=c),rows:"3",class:"input w-full resize-none",placeholder:x(o)("projects.descriptionPlaceholder")},null,8,Dt),[[re,m.value.description]])])])]),_:1},8,["is-open","title"]),n(oe,{"is-open":f.value,"onUpdate:isOpen":y[8]||(y[8]=c=>f.value=c),title:x(o)("projects.deleteTitle"),onClose:I},{footer:H(()=>[e("button",{onClick:I,class:"px-4 py-2 rounded-lg font-medium transition-all duration-200",style:{"background-color":"var(--bg-primary)",border:"1px solid var(--bg-border)",color:"var(--text-primary)"}},h(x(o)("common.cancel")),1),e("button",{onClick:z,class:"px-4 py-2 rounded-lg font-medium transition-all duration-200",style:{"background-color":"#dc2626","border-color":"#dc2626",color:"white"}},h(x(o)("projects.delete")),1)]),default:H(()=>[e("p",Rt,h(x(o)("projects.deleteConfirm",{name:N.value?.name})),1)]),_:1},8,["is-open","title"])])}}},Ht={key:0,class:"mb-6"},Kt={class:"mb-6"},Ot={key:0,class:"text-xs font-semibold mb-3 transition-colors duration-200 hidden sm:block tracking-wide",style:{color:"var(--text-primary)"}},At={class:"space-y-1",role:"navigation","aria-label":"Navigation générale"},zt={class:"space-y-1"},Vt={key:0,class:"text-xs sm:text-sm font-medium truncate ml-2"},qt={key:0,class:"ml-6 space-y-1"},Yt={key:0,class:"space-y-2"},Ft={key:1,class:"space-y-1",role:"navigation","aria-label":"Navigation des catégories"},Gt=["onClick","onKeydown","aria-current","aria-label","title"],Wt={class:"text-xs font-medium truncate"},Xt={key:0,class:"text-xs sm:text-sm font-medium truncate ml-2"},Zt={key:0,class:"text-xs sm:text-sm font-medium truncate ml-2"},Jt={key:0,class:"text-xs sm:text-sm font-medium truncate ml-2"},Qt={key:1},er={key:0,class:"text-center"},tr={class:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center",style:{"background-color":"var(--bg-border)"}},rr={class:"text-sm font-semibold mb-2 transition-colors duration-200",style:{color:"var(--text-primary)"}},or={class:"text-xs transition-colors duration-200",style:{color:"var(--text-secondary)"}},sr={__name:"DashboardSidebar",props:{isSidebarCollapsed:{type:Boolean,default:!1}},emits:["toggle-sidebar","project-changed"],setup(t,{emit:k}){const o=k,v=j(!1),l=j(!1),u=j(null),i=F(),{t:b}=G(),f=E(()=>i.hasProjects);E(()=>i.currentProjectId);const d=E(()=>i.currentProject),U=ve("web-prelaunch");Z(()=>d.value?.checklistType,r=>{r&&U.setChecklistType&&U.setChecklistType(r)},{immediate:!0});const m=E(()=>{try{if(!U||!d.value?.checklistType)return[];const{getAllCategories:r,getCategoryData:S}=U;return r().map(g=>{try{const p=S(g),M=b(`categories.${g}.name`),I=N(g);return{id:g,name:M,icon:I}}catch{return{id:g,name:`Catégorie ${g}`,icon:"heroicons:document-text"}}})}catch{return[]}}),N=r=>({seo:"heroicons:magnifying-glass",accessibilite:"heroicons:heart",performance:"heroicons:bolt","eco-conception":"heroicons:globe-alt","responsive-ux":"heroicons:device-phone-mobile",securite:"heroicons:shield-check",analytics:"heroicons:chart-bar","reseau-chiffrement":"heroicons:lock-closed","authentification-acces":"heroicons:key","protection-attaques":"heroicons:shield-exclamation","fichiers-donnees":"heroicons:document-check","maintenance-surveillance":"heroicons:eye","app-store":"heroicons:device-phone-mobile","play-store":"heroicons:device-phone-mobile",technical:"heroicons:cog",legal:"heroicons:scale"})[r]||"heroicons:document-text",P=async r=>{try{l.value=!0,i.setCurrentProject(r),u.value=null,o("project-changed",r)}catch{}finally{setTimeout(()=>{l.value=!1},300)}},L=r=>{try{{const S=document.getElementById(`category-${r}`);S&&(u.value=r,window.dispatchEvent(new CustomEvent("open-category",{detail:{categoryId:r}})),setTimeout(()=>{try{const p=S.offsetTop-80-20;window.scrollTo({top:Math.max(0,p),behavior:"smooth"})}catch{}},300))}}catch{}},B=()=>{try{if(m.value&&Array.isArray(m.value)){const r=window.scrollY,S=window.innerHeight,$=80;let g=null,p=1/0;m.value.forEach(M=>{try{const I=document.getElementById(`category-${M.id}`);if(I){const z=I.getBoundingClientRect(),C=Math.abs(z.top-$);C<p&&(p=C,g=M.id)}}catch{}}),g&&g!==u.value&&(u.value=g)}}catch{}};return W(()=>{v.value=!0,window.addEventListener("scroll",B)}),X(()=>{window.removeEventListener("scroll",B)}),(r,S)=>{const $=Y,g=he;return s(),a("aside",{class:T(["fixed left-0 top-[77px] border-r transition-all duration-500 ease-in-out h-[calc(100vh-77px)] flex flex-col z-10 shadow-lg",t.isSidebarCollapsed?"w-14":"w-72"]),style:{"border-color":"var(--bg-border)","background-color":"var(--bg-surface)"},role:"navigation","aria-label":"Navigation des vérifications"},[e("div",{class:T(["flex-1 min-h-0 overflow-auto",t.isSidebarCollapsed?"px-2 pb-0 pt-4":"p-4 pb-0 pt-4"])},[t.isSidebarCollapsed?w("",!0):(s(),a("div",Ht,[n(Bt,{onProjectChanged:P})])),e("div",Kt,[t.isSidebarCollapsed?w("",!0):(s(),a("h3",Ot," Navigation ")),e("nav",At,[e("div",zt,[n(g,{to:"/dashboard",class:T(["rounded-xl transition-all duration-200 flex items-center",[t.isSidebarCollapsed?"w-10 h-10 mx-auto justify-center":"w-full text-left px-2 py-2 sm:px-3 sm:py-2"]]),style:A({backgroundColor:(r._.provides[D]||r.$route).path==="/dashboard"?"var(--bg-border)":"transparent",color:"var(--text-primary)"}),"aria-current":(r._.provides[D]||r.$route).path==="/dashboard"?"page":void 0,title:t.isSidebarCollapsed?"Tableau de bord":void 0},{default:H(()=>[n($,{name:"heroicons:home",class:T(["flex-shrink-0",t.isSidebarCollapsed?"w-5 h-5":"w-5 h-5 mr-0.5"]),style:{color:"var(--text-primary)"},"aria-hidden":"true"},null,8,["class"]),t.isSidebarCollapsed?w("",!0):(s(),a("span",Vt,"Tableau de bord"))]),_:1},8,["class","style","aria-current","title"]),v.value&&f.value&&d.value?.checklistType&&(r._.provides[D]||r.$route).path==="/dashboard"&&!t.isSidebarCollapsed?(s(),a("div",qt,[l.value?(s(),a("div",Yt,[(s(),a(Q,null,ee(5,p=>e("div",{key:`skeleton-category-${p}`,class:"rounded-xl h-8 animate-pulse",style:{"background-color":"var(--bg-border)"}})),64))])):(s(),a("nav",Ft,[(s(!0),a(Q,null,ee(m.value,p=>(s(),a("button",{key:p.id,onClick:M=>L(p.id),onKeydown:[R(M=>L(p.id),["enter"]),R(V(M=>L(p.id),["prevent"]),["space"])],class:"rounded-lg transition-all duration-200 flex items-center w-full text-left px-2 py-1.5 text-xs",style:A({backgroundColor:u.value===p.id?"var(--bg-border)":"transparent",color:"var(--text-primary)",borderColor:"transparent"}),"aria-current":u.value===p.id?"location":void 0,"aria-label":r.$t("common.goToCategory",{name:p.name}),title:r.$t("common.goToCategory",{name:p.name}),role:"menuitem",tabindex:"0"},[n($,{name:p.icon,class:"w-4 h-4 mr-2 flex-shrink-0",style:{color:"var(--text-primary)"},"aria-hidden":"true"},null,8,["name"]),e("span",Wt,h(p.name),1)],44,Gt))),128))]))])):w("",!0)]),n(g,{to:"/profile",class:T(["rounded-xl transition-all duration-200 flex items-center",[t.isSidebarCollapsed?"w-10 h-10 mx-auto justify-center":"w-full text-left px-2 py-2 sm:px-3 sm:py-2"]]),style:A({backgroundColor:(r._.provides[D]||r.$route).path==="/profile"?"var(--bg-border)":"transparent",color:"var(--text-primary)"}),"aria-current":(r._.provides[D]||r.$route).path==="/profile"?"page":void 0,title:t.isSidebarCollapsed?"Mon profil":void 0},{default:H(()=>[n($,{name:"heroicons:user",class:T(["flex-shrink-0",t.isSidebarCollapsed?"w-5 h-5":"w-5 h-5 mr-0.5"]),style:{color:"var(--text-primary)"},"aria-hidden":"true"},null,8,["class"]),t.isSidebarCollapsed?w("",!0):(s(),a("span",Xt,"Mon profil"))]),_:1},8,["class","style","aria-current","title"]),n(g,{to:"/settings",class:T(["rounded-xl transition-all duration-200 flex items-center",[t.isSidebarCollapsed?"w-10 h-10 mx-auto justify-center":"w-full text-left px-2 py-2 sm:px-3 sm:py-2"]]),style:A({backgroundColor:(r._.provides[D]||r.$route).path==="/settings"?"var(--bg-border)":"transparent",color:"var(--text-primary)"}),"aria-current":(r._.provides[D]||r.$route).path==="/settings"?"page":void 0,title:t.isSidebarCollapsed?"Paramètres":void 0},{default:H(()=>[n($,{name:"heroicons:cog-6-tooth",class:T(["flex-shrink-0",t.isSidebarCollapsed?"w-5 h-5":"w-5 h-5 mr-0.5"]),style:{color:"var(--text-primary)"},"aria-hidden":"true"},null,8,["class"]),t.isSidebarCollapsed?w("",!0):(s(),a("span",Zt,"Paramètres"))]),_:1},8,["class","style","aria-current","title"]),n(g,{to:"/help",class:T(["rounded-xl transition-all duration-200 flex items-center",[t.isSidebarCollapsed?"w-10 h-10 mx-auto justify-center":"w-full text-left px-2 py-2 sm:px-3 sm:py-2"]]),style:A({backgroundColor:(r._.provides[D]||r.$route).path==="/help"?"var(--bg-border)":"transparent",color:"var(--text-primary)"}),"aria-current":(r._.provides[D]||r.$route).path==="/help"?"page":void 0,title:t.isSidebarCollapsed?"Aide":void 0},{default:H(()=>[n($,{name:"heroicons:question-mark-circle",class:T(["flex-shrink-0",t.isSidebarCollapsed?"w-5 h-5":"w-5 h-5 mr-0.5"]),style:{color:"var(--text-primary)"},"aria-hidden":"true"},null,8,["class"]),t.isSidebarCollapsed?w("",!0):(s(),a("span",Jt,"Aide & Support"))]),_:1},8,["class","style","aria-current","title"])])]),v.value&&f.value&&d.value?.checklistType&&(r._.provides[D]||r.$route).path==="/dashboard"?(s(),a("div",Qt,[v.value&&!t.isSidebarCollapsed&&(!f.value||!d.value?.checklistType)&&(r._.provides[D]||r.$route).path==="/dashboard"?(s(),a("div",er,[e("div",tr,[n($,{name:"heroicons:folder",class:"w-8 h-8",style:{color:"var(--accent-primary)"},"aria-hidden":"true"})]),e("h3",rr,h(f.value?"Choisir un type de checklist":r.$t("sidebar.welcome")),1),e("p",or,h(f.value?"Sélectionnez le type de checklist qui correspond à votre projet":r.$t("sidebar.createProjectMessage")),1)])):w("",!0)])):w("",!0)],2)],2)}}},ar=le(ie),lr={class:"pt-[77px] flex items-stretch overflow-hidden"},vr={__name:"dashboard",setup(t){const k=F(),{currentUser:o,ready:v}=J(),l=E(()=>k.currentProjectId);Z([o,v],([d,U])=>{U&&d&&!k.isSynced&&k.subscribeUserProjects(d.uid)},{immediate:!0});const u=()=>{window.dispatchEvent(new CustomEvent("reset-checklist-progress"))},i=d=>{},b=j(!1),f=()=>{b.value=!b.value};return(d,U)=>{const m=ar;return s(),a("div",null,[n(m),n(lt,{"current-project-id":l.value,"is-sidebar-collapsed":b.value,onResetProgress:u,onToggleSidebar:f},null,8,["current-project-id","is-sidebar-collapsed"]),e("div",lr,[n(sr,{"is-sidebar-collapsed":b.value,onToggleSidebar:f,onProjectChanged:i},null,8,["is-sidebar-collapsed"]),e("main",{class:T(["w-full min-w-0 min-h-0 overflow-auto bg-[var(--bg-primary)] transition-all duration-500 ease-in-out",b.value?"ml-14":"ml-72"]),style:{height:"calc(100vh - 77px)"},role:"main","aria-label":"Contenu principal des vérifications"},[me(d.$slots,"default")],2)]),n(ne)])}}};export{vr as default};
