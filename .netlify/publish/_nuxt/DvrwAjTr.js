import X from"./C7tlBJhT.js";import{u as de}from"./DLohyXaz.js";import{r as b,c as s,o as t,a as e,b as $,t as i,$ as F,a0 as H,aj as se,Z as Y,h as K,n as ye,_ as ue,l as q,g as W,f as g,ag as z,ah as N,j as U,w as oe,k as ne,e as ie,af as _e,a2 as xe,a6 as re,u as te,a3 as B,F as le,ap as Ae,a1 as Te,aq as Ve,m as be}from"./Dylfgz3Y.js";import{u as me}from"./C4af-smZ.js";import{u as Le,M as Oe}from"./CeTxgx5B.js";const Me={class:"flex flex-col items-center justify-center w-full px-4 py-12"},Ue={class:"text-center w-full max-w-md"},De={class:"w-16 h-16 mx-auto mb-6 rounded-xl flex items-center justify-center",style:{"background-color":"var(--bg-border)"}},qe={class:"text-2xl font-bold mb-3 transition-colors duration-200 tracking-tight",style:{color:"var(--text-primary)"}},Re={class:"text-sm mb-6 transition-colors duration-200 leading-relaxed max-w-sm mx-auto",style:{color:"var(--text-secondary)"}},ze={class:"w-full mx-auto space-y-4"},Ne={for:"project-name",class:"block text-sm font-semibold mb-2 transition-colors duration-200",style:{color:"var(--text-primary)"}},Be=["placeholder"],Fe={for:"project-description",class:"block text-sm font-semibold mb-2 transition-colors duration-200",style:{color:"var(--text-primary)"}},He=["placeholder"],Xe=["onKeydown","disabled","aria-label"],Ke={__name:"DashboardEmptyState",emits:["create-project"],setup(o,{emit:f}){const n=f,l=de(),{currentUser:u}=me(),v=b(""),m=b(""),p=b(null),d=async()=>{if(!(!v.value.trim()||!u.value))try{const c=await l.addProjectRemote(u.value.uid,{name:v.value.trim(),description:m.value.trim(),checklistType:p.value});l.setCurrentProject(c.id),n("create-project",c),c.checklistType||await ye("/select-checklist")}catch(c){console.error("Erreur lors de la création du projet:",c)}};return(c,w)=>{const A=X;return t(),s("div",Me,[e("div",Ue,[e("div",De,[$(A,{name:"fluent-emoji:snake",class:"w-8 h-8",style:{color:"var(--accent-primary)"},"aria-hidden":"true"})]),e("h1",qe,i(c.$t("emptyState.title")),1),e("p",Re,i(c.$t("emptyState.description")),1),e("div",ze,[e("div",null,[e("label",Ne,i(c.$t("projects.name")),1),F(e("input",{id:"project-name","onUpdate:modelValue":w[0]||(w[0]=_=>v.value=_),type:"text",placeholder:c.$t("projects.namePlaceholder"),class:"input w-full h-10",onKeydown:se(d,["enter"])},null,40,Be),[[H,v.value]])]),e("div",null,[e("label",Fe,i(c.$t("projects.description")),1),F(e("textarea",{id:"project-description","onUpdate:modelValue":w[1]||(w[1]=_=>m.value=_),placeholder:c.$t("projects.descriptionPlaceholder"),rows:"3",class:"input w-full h-20 resize-none"},null,8,He),[[H,m.value]])]),e("button",{onClick:d,onKeydown:[se(d,["enter"]),se(Y(d,["prevent"]),["space"])],disabled:!v.value.trim(),class:"btn btn-primary w-full h-10 text-sm font-semibold disabled:opacity-50 disabled:cursor-not-allowed","aria-label":c.$t("emptyState.createButton"),role:"button",tabindex:"0"},[$(A,{name:"heroicons:plus",class:"w-4 h-4 inline mr-2","aria-hidden":"true"}),K(" "+i(c.$t("emptyState.createButton")),1)],40,Xe)])])])}}},Ze=["aria-expanded","aria-controls","aria-label"],We={class:"flex items-center justify-between"},Je={class:"flex items-center space-x-4 flex-1"},Qe=["aria-checked","aria-label"],Ge={class:"flex-1 min-w-0"},Ye=["innerHTML"],et={class:"text-base transition-colors duration-200",style:{color:"var(--text-secondary)"}},tt=["aria-expanded","aria-label"],st={__name:"ChecklistItemHeader",props:{item:{type:Object,required:!0},isItemChecked:{type:Boolean,required:!0},isExpanded:{type:Boolean,required:!0}},emits:["toggle-accordion","toggle-item"],setup(o){return(f,n)=>{const l=X;return t(),s("div",{class:"p-4 cursor-pointer transition-all duration-200 hover:bg-opacity-80",onClick:n[3]||(n[3]=u=>f.$emit("toggle-accordion")),onKeydown:[n[4]||(n[4]=se(u=>f.$emit("toggle-accordion"),["enter"])),n[5]||(n[5]=se(Y(u=>f.$emit("toggle-accordion"),["prevent"]),["space"]))],role:"button","aria-expanded":o.isExpanded,"aria-controls":`item-details-${o.item.id}`,"aria-label":`${o.isExpanded?f.$t("items.accordion.closeDetails"):f.$t("items.accordion.openDetails")} de ${o.item.label}`,tabindex:"0"},[e("div",We,[e("div",Je,[e("button",{onClick:n[0]||(n[0]=Y(u=>f.$emit("toggle-item"),["stop"])),onKeydown:[n[1]||(n[1]=se(Y(u=>f.$emit("toggle-item"),["stop"]),["enter"])),n[2]||(n[2]=se(Y(u=>f.$emit("toggle-item"),["stop","prevent"]),["space"]))],class:q(["flex-shrink-0 w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all duration-300 hover:scale-105 relative overflow-hidden",{"bg-gradient-to-br from-green-400 to-green-600 shadow-lg shadow-green-500/30":o.isItemChecked,"border-gray-300 hover:border-gray-400":!o.isItemChecked}]),"aria-checked":o.isItemChecked,"aria-label":`${o.isItemChecked?f.$t("items.accordion.uncheck"):f.$t("items.accordion.check")} ${o.item.label}`,role:"checkbox",tabindex:"0"},[o.isItemChecked?(t(),W(l,{key:0,name:"heroicons:check",class:q(["w-3 h-3 transition-all duration-300 text-white drop-shadow-sm",{"animate-bounce-in":o.isItemChecked}]),"aria-hidden":"true"},null,8,["class"])):g("",!0)],42,Qe),e("div",Ge,[e("h3",{class:"text-lg font-semibold leading-tight transition-colors duration-200 mb-2",style:{color:"var(--text-primary)"},innerHTML:o.item.label},null,8,Ye),e("p",et,i(o.item.description),1)])]),e("button",{class:q(["flex-shrink-0 w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-200 hover:bg-opacity-80",{"rotate-180":o.isExpanded&&!o.isItemChecked}]),"aria-expanded":o.isExpanded,"aria-label":`${o.isExpanded?f.$t("items.accordion.close"):f.$t("items.accordion.open")} les détails`,"aria-hidden":"true"},[o.isItemChecked?(t(),W(l,{key:0,name:"heroicons:check-circle",class:"w-5 h-5 transition-colors duration-200",style:{color:"var(--accent-primary)"},"aria-hidden":"true"})):(t(),W(l,{key:1,name:"heroicons:chevron-down",class:"w-5 h-5 transition-colors duration-200",style:{color:"var(--text-muted)"},"aria-hidden":"true"}))],10,tt)])],40,Ze)}}},ot=ue(st,[["__scopeId","data-v-1971e5f8"]]),lt={key:0,class:"space-y-3"},at={class:"text-lg font-semibold transition-colors duration-200",style:{color:"var(--accent-primary)"}},rt={class:"text-base leading-relaxed transition-colors duration-200",style:{color:"var(--text-secondary)"}},nt={__name:"ChecklistItemExplication",props:{explication:{type:String,default:null}},setup(o){return(f,n)=>o.explication?(t(),s("div",lt,[e("h4",at,i(f.$t("items.details.explication")),1),e("p",rt,i(o.explication),1)])):g("",!0)}},it={key:0,class:"space-y-2"},ct={class:"space-y-1",role:"list"},dt=["innerHTML"],ut={__name:"ChecklistItemCommentFaire",props:{commentFaire:{type:Array,default:()=>[]}},setup(o){return(f,n)=>{const l=X;return o.commentFaire&&o.commentFaire.length>0?(t(),s("div",it,[n[0]||(n[0]=e("h4",{class:"text-lg font-semibold transition-colors duration-200",style:{color:"var(--accent-primary)"}}," Comment faire ",-1)),e("ul",ct,[(t(!0),s(z,null,N(o.commentFaire,(u,v)=>(t(),s("li",{key:v,class:"text-sm leading-relaxed transition-colors duration-200 flex items-start space-x-2",style:{color:"var(--text-secondary)"},role:"listitem"},[$(l,{name:"heroicons:arrow-right",class:"w-4 h-4 flex-shrink-0 mt-0.5 transition-colors duration-200",style:{color:"var(--accent-primary)",position:"relative","z-index":"0"},"aria-hidden":"true"}),e("span",{innerHTML:u},null,8,dt)]))),128))])])):g("",!0)}}},mt={key:0,class:"space-y-3"},vt={class:"text-lg font-semibold transition-colors duration-200",style:{color:"var(--accent-primary)"}},pt={class:"space-y-4"},yt={key:0,class:"space-y-1"},ht={class:"text-xs p-3 rounded overflow-x-auto",style:{"background-color":"var(--bg-code)"},role:"code","aria-label":"Exemple"},ft={style:{color:"var(--text-code)"}},xt={key:1,class:"space-y-4"},bt={key:0,class:"text-sm transition-colors duration-200",style:{color:"var(--text-muted)"}},gt={key:1,class:"space-y-1"},kt={class:"text-xs p-3 rounded overflow-x-auto",style:{"background-color":"var(--bg-code)"},role:"code","aria-label":"Exemple"},_t={style:{color:"var(--text-code)"}},wt={key:2,class:"space-y-2"},$t={key:0,class:"space-y-1"},Ct={class:"text-xs p-3 rounded overflow-x-auto",style:{"background-color":"var(--bg-code)"},role:"code","aria-label":"Exemple HTML"},jt={style:{color:"var(--text-code)"}},St={key:1,class:"space-y-1"},Pt={class:"text-xs p-3 rounded overflow-x-auto",style:{"background-color":"var(--bg-code)"},role:"code","aria-label":"Exemple CSS"},It={style:{color:"var(--text-code)"}},Et={key:2,class:"space-y-1"},At={class:"text-xs p-3 rounded overflow-x-auto",style:{"background-color":"var(--bg-code)"},role:"code","aria-label":"Exemple JavaScript"},Tt={style:{color:"var(--text-code)"}},Vt={key:3,class:"space-y-1"},Lt={class:"text-xs p-3 rounded overflow-x-auto",style:{"background-color":"var(--bg-code)"},role:"code","aria-label":"Exemple PHP"},Ot={style:{color:"var(--text-code)"}},Mt={key:4,class:"space-y-1"},Ut={class:"text-xs p-3 rounded overflow-x-auto",style:{"background-color":"var(--bg-code)"},role:"code","aria-label":"Exemple Node.js"},Dt={style:{color:"var(--text-code)"}},qt={key:5,class:"space-y-1"},Rt={class:"text-xs p-3 rounded overflow-x-auto",style:{"background-color":"var(--bg-code)"},role:"code","aria-label":"Exemple Apache"},zt={style:{color:"var(--text-code)"}},Nt={key:6,class:"space-y-1"},Bt={class:"text-xs p-3 rounded overflow-x-auto",style:{"background-color":"var(--bg-code)"},role:"code","aria-label":"Exemple Nginx"},Ft={style:{color:"var(--text-code)"}},Ht={key:3,class:"rounded-xl overflow-hidden",style:{"background-color":"var(--bg-code)"}},Xt=["src","alt"],Kt={__name:"ChecklistItemExemple",props:{exemple:{type:[String,Object],default:null}},setup(o){const f=o;return U(()=>f.exemple?typeof f.exemple=="string"?!0:f.exemple.code||f.exemple.exemple||f.exemple.html||f.exemple.css||f.exemple.javascript||f.exemple.php||f.exemple.nodejs||f.exemple.apache||f.exemple.nginx:!1),(n,l)=>o.exemple?(t(),s("div",mt,[e("h4",vt,i(n.$t("items.details.exemple")),1),e("div",pt,[typeof o.exemple=="string"?(t(),s("div",yt,[l[0]||(l[0]=e("div",{class:"text-xs font-medium transition-colors duration-200",style:{color:"var(--text-muted)"}},"Exemple",-1)),e("pre",ht,[e("code",ft,i(o.exemple),1)])])):typeof o.exemple=="object"?(t(),s("div",xt,[o.exemple.description?(t(),s("div",bt,i(o.exemple.description),1)):g("",!0),o.exemple.exemple?(t(),s("div",gt,[l[1]||(l[1]=e("div",{class:"text-xs font-medium transition-colors duration-200",style:{color:"var(--text-muted)"}},"Exemple",-1)),e("pre",kt,[e("code",_t,i(o.exemple.exemple),1)])])):g("",!0),o.exemple.code?(t(),s("div",wt,[o.exemple.code.html?(t(),s("div",$t,[l[2]||(l[2]=e("div",{class:"text-xs font-medium transition-colors duration-200",style:{color:"var(--text-muted)"}},"HTML",-1)),e("pre",Ct,[e("code",jt,i(o.exemple.code.html),1)])])):g("",!0),o.exemple.code.css?(t(),s("div",St,[l[3]||(l[3]=e("div",{class:"text-xs font-medium transition-colors duration-200",style:{color:"var(--text-muted)"}},"CSS",-1)),e("pre",Pt,[e("code",It,i(o.exemple.code.css),1)])])):g("",!0),o.exemple.code.javascript?(t(),s("div",Et,[l[4]||(l[4]=e("div",{class:"text-xs font-medium transition-colors duration-200",style:{color:"var(--text-muted)"}},"JavaScript",-1)),e("pre",At,[e("code",Tt,i(o.exemple.code.javascript),1)])])):g("",!0),o.exemple.code.php?(t(),s("div",Vt,[l[5]||(l[5]=e("div",{class:"text-xs font-medium transition-colors duration-200",style:{color:"var(--text-muted)"}},"PHP",-1)),e("pre",Lt,[e("code",Ot,i(o.exemple.code.php),1)])])):g("",!0),o.exemple.code.nodejs?(t(),s("div",Mt,[l[6]||(l[6]=e("div",{class:"text-xs font-medium transition-colors duration-200",style:{color:"var(--text-muted)"}},"Node.js",-1)),e("pre",Ut,[e("code",Dt,i(o.exemple.code.nodejs),1)])])):g("",!0),o.exemple.code.apache?(t(),s("div",qt,[l[7]||(l[7]=e("div",{class:"text-xs font-medium transition-colors duration-200",style:{color:"var(--text-muted)"}},"Apache",-1)),e("pre",Rt,[e("code",zt,i(o.exemple.code.apache),1)])])):g("",!0),o.exemple.code.nginx?(t(),s("div",Nt,[l[8]||(l[8]=e("div",{class:"text-xs font-medium transition-colors duration-200",style:{color:"var(--text-muted)"}},"Nginx",-1)),e("pre",Bt,[e("code",Ft,i(o.exemple.code.nginx),1)])])):g("",!0)])):g("",!0),o.exemple.image?(t(),s("div",Ht,[e("img",{src:o.exemple.image,alt:o.exemple.imageAlt||"Exemple visuel",class:"w-full h-auto",loading:"lazy"},null,8,Xt)])):g("",!0)])):g("",!0)])])):g("",!0)}},Zt={key:0,class:"space-y-2"},Wt={class:"text-lg font-semibold transition-colors duration-200",style:{color:"var(--accent-primary)"}},Jt={class:"space-y-1",role:"list"},Qt={__name:"ChecklistItemBonnesPratiques",props:{bonnesPratiques:{type:Array,default:()=>[]}},setup(o){return(f,n)=>{const l=X;return o.bonnesPratiques&&o.bonnesPratiques.length>0?(t(),s("div",Zt,[e("h4",Wt,i(f.$t("items.details.bonnesPratiques")),1),e("ul",Jt,[(t(!0),s(z,null,N(o.bonnesPratiques,(u,v)=>(t(),s("li",{key:v,class:"text-sm leading-relaxed transition-colors duration-200 flex items-start space-x-2",style:{color:"var(--text-secondary)"},role:"listitem"},[$(l,{name:"heroicons:check-circle",class:"w-4 h-4 flex-shrink-0 mt-0.5 transition-colors duration-200",style:{color:"var(--accent-primary)",position:"relative","z-index":"0"},"aria-hidden":"true"}),e("span",null,i(u),1)]))),128))])])):g("",!0)}}},Gt={key:0,class:"space-y-3"},Yt={class:"text-lg font-semibold transition-colors duration-200",style:{color:"var(--accent-primary)"}},es={class:"space-y-3"},ts=["href","title"],ss={class:"flex-1 min-w-0"},os={class:"font-medium transition-colors duration-200",style:{color:"var(--text-primary)"}},ls={class:"text-sm transition-colors duration-200",style:{color:"var(--text-muted)"}},as={__name:"ChecklistItemRessources",props:{ressources:{type:Array,default:()=>[]}},setup(o){return(f,n)=>{const l=X;return o.ressources&&o.ressources.length>0?(t(),s("div",Gt,[e("h4",Yt,i(f.$t("items.details.ressources")),1),e("div",es,[(t(!0),s(z,null,N(o.ressources,u=>(t(),s("a",{key:u.url,href:u.url,target:"_blank",rel:"noopener noreferrer",class:"flex items-center space-x-3 p-4 rounded-xl transition-all duration-200 hover:bg-opacity-80",style:{"background-color":"var(--bg-surface)",border:"1px solid var(--bg-border)"},title:u.title},[$(l,{name:"heroicons:arrow-top-right-on-square",class:"w-5 h-5 flex-shrink-0 transition-colors duration-200",style:{color:"var(--accent-primary)"},"aria-hidden":"true"}),e("div",ss,[e("div",os,i(u.title),1),e("div",ls,i(u.description),1)])],8,ts))),128))])])):g("",!0)}}},rs={key:0,class:"space-y-3"},ns={class:"text-lg font-semibold transition-colors duration-200",style:{color:"var(--accent-primary)"}},is={class:"space-y-3"},cs={class:"text-base transition-colors duration-200",style:{color:"var(--text-secondary)"}},ds={__name:"ChecklistItemConseils",props:{conseils:{type:Array,default:()=>[]}},setup(o){return(f,n)=>{const l=X;return o.conseils&&o.conseils.length>0?(t(),s("div",rs,[e("h4",ns,i(f.$t("items.details.conseils")),1),e("div",is,[(t(!0),s(z,null,N(o.conseils,u=>(t(),s("div",{key:u,class:"flex items-start space-x-3 p-4 rounded-xl",style:{"background-color":"var(--bg-surface)",border:"1px solid var(--bg-border)"}},[$(l,{name:"heroicons:light-bulb",class:"w-5 h-5 flex-shrink-0 mt-0.5 transition-colors duration-200",style:{color:"var(--accent-primary)"},"aria-hidden":"true"}),e("p",cs,i(u),1)]))),128))])])):g("",!0)}}},us=["id","aria-label"],ms={class:"p-6 space-y-6"},vs={key:0,class:"text-center py-8"},ps={class:"text-base transition-colors duration-200",style:{color:"var(--text-muted)"}},ys={__name:"ChecklistItemDetails",props:{item:{type:Object,required:!0},isExpanded:{type:Boolean,required:!0}},setup(o){return(f,n)=>(t(),s("div",{id:`item-details-${o.item.id}`,class:q(["border-t transition-all duration-700 ease-out overflow-hidden",{"max-h-0 opacity-0":!o.isExpanded,"max-h-[10000px] opacity-100":o.isExpanded}]),style:{"border-color":"var(--bg-border)","background-color":"var(--bg-primary)"},role:"region","aria-label":`Détails de ${o.item.label}`},[e("div",ms,[o.item.details?g("",!0):(t(),s("div",vs,[e("p",ps,i(f.$t("items.details.noDetails")),1)])),o.item.details&&o.item.details.explication?(t(),W(nt,{key:1,explication:o.item.details.explication},null,8,["explication"])):g("",!0),o.item.details&&o.item.details.commentFaire?(t(),W(ut,{key:2,"comment-faire":o.item.details.commentFaire},null,8,["comment-faire"])):g("",!0),o.item.details&&o.item.details.exemple?(t(),W(Kt,{key:3,exemple:o.item.details.exemple},null,8,["exemple"])):g("",!0),o.item.details&&o.item.details.bonnesPratiques?(t(),W(Qt,{key:4,"bonnes-pratiques":o.item.details.bonnesPratiques},null,8,["bonnes-pratiques"])):g("",!0),o.item.details&&o.item.details.ressources?(t(),W(as,{key:5,ressources:o.item.details.ressources},null,8,["ressources"])):g("",!0),o.item.details&&o.item.details.conseils?(t(),W(ds,{key:6,conseils:o.item.details.conseils},null,8,["conseils"])):g("",!0)])],10,us))}},hs=["aria-label"],fs={__name:"ChecklistItemAccordion",props:{item:{type:Object,required:!0},isItemChecked:{type:Boolean,required:!0}},emits:["toggle-item","accordion-opened","accordion-closed"],setup(o,{emit:f}){const n=o,l=f,u=b(!1),v=()=>{n.isItemChecked||(u.value=!u.value,u.value?l("accordion-opened",n.item.id):l("accordion-closed",n.item.id))},m=()=>{n.isItemChecked?u.value=!0:u.value=!1,l("toggle-item",n.item.id)},p=c=>{c.detail.itemId===n.item.id&&(u.value=!1)},d=c=>{c.detail.itemId===n.item.id&&(u.value=!0)};return oe(()=>n.isItemChecked,(c,w)=>{c&&!w?u.value=!1:!c&&w&&(u.value=!0)}),ne(()=>{window.addEventListener("close-item-accordion",p),window.addEventListener("open-item-accordion",d)}),ie(()=>{window.removeEventListener("close-item-accordion",p),window.removeEventListener("open-item-accordion",d)}),(c,w)=>(t(),s("div",{class:"card",role:"region","aria-label":c.$t("common.item",{label:o.item.label})},[$(ot,{item:o.item,"is-item-checked":o.isItemChecked,"is-expanded":u.value,onToggleAccordion:v,onToggleItem:m},null,8,["item","is-item-checked","is-expanded"]),$(ys,{item:o.item,"is-expanded":u.value},null,8,["item","is-expanded"])],8,hs))}},xs={class:"card p-12 max-w-4xl mx-auto mb-12 relative overflow-hidden",style:{background:"linear-gradient(135deg, var(--accent-primary), var(--accent-secondary))",border:"1px solid var(--bg-border)"}},bs={class:"relative z-10 text-center"},gs={class:"mb-4 flex items-center justify-center gap-3"},ks={__name:"ChecklistDeploymentReadyCard",props:{totalItems:{type:Number,required:!1,default:0},totalCategories:{type:Number,required:!1,default:0}},setup(o){return(f,n)=>{const l=X;return t(),s("div",xs,[e("div",bs,[e("div",gs,[$(l,{name:"fluent-emoji:check-mark-button",class:"w-8 h-8","aria-hidden":"true"}),n[0]||(n[0]=e("h1",{class:"text-4xl md:text-5xl font-bold text-white"}," Félicitations ! ",-1))]),n[1]||(n[1]=e("h2",{class:"text-2xl md:text-3xl font-semibold mb-6 text-white/90"}," Votre site est prêt pour le déploiement ",-1)),n[2]||(n[2]=e("p",{class:"text-lg md:text-xl text-white/90 max-w-2xl mx-auto leading-relaxed"}," Toutes les catégories sont complétées. Vous pouvez lancer le déploiement en toute confiance. ",-1))])])}}},_s={class:"rounded-lg border animate-pulse",style:{"background-color":"var(--bg-primary)","border-color":"var(--bg-border)"}},ws={__name:"CommonSkeletonCategory",setup(o){return(f,n)=>(t(),s("div",_s,n[0]||(n[0]=[_e('<div class="p-6"><div class="flex items-center justify-between"><div class="flex items-center space-x-4"><div class="w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-600 animate-pulse"></div><div class="space-y-2"><div class="h-6 w-32 bg-gray-300 dark:bg-gray-600 rounded animate-pulse"></div><div class="h-4 w-48 bg-gray-300 dark:bg-gray-600 rounded animate-pulse"></div></div></div><div class="flex items-center space-x-4"><div class="text-right space-y-1"><div class="h-4 w-12 bg-gray-300 dark:bg-gray-600 rounded animate-pulse"></div><div class="h-3 w-16 bg-gray-300 dark:bg-gray-600 rounded animate-pulse"></div></div><div class="w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-600 animate-pulse"></div></div></div></div>',1)])))}},$s={class:"rounded-lg border animate-pulse",style:{"background-color":"var(--bg-primary)","border-color":"var(--bg-border)"}},Cs={__name:"CommonSkeletonItem",setup(o){return(f,n)=>(t(),s("div",$s,n[0]||(n[0]=[_e('<div class="p-4"><div class="flex items-center justify-between"><div class="flex items-center space-x-3 flex-1"><div class="w-6 h-6 rounded border-2 bg-gray-300 dark:bg-gray-600 animate-pulse"></div><div class="flex-1 min-w-0 space-y-2"><div class="h-4 w-3/4 bg-gray-300 dark:bg-gray-600 rounded animate-pulse"></div><div class="h-3 w-1/2 bg-gray-300 dark:bg-gray-600 rounded animate-pulse"></div></div></div><div class="w-8 h-8 rounded bg-gray-300 dark:bg-gray-600 animate-pulse"></div></div></div>',1)])))}},js={class:"w-full",style:{"min-height":"calc(100vh + 200px)"}},Ss={class:"space-y-6",role:"region","aria-label":"Catégories de la checklist"},Ps=["aria-label"],Is=["onClick","onKeydown","aria-expanded","aria-controls","aria-label"],Es={class:"flex items-center justify-between relative z-10"},As={class:"flex items-center space-x-4"},Ts={class:"flex-shrink-0"},Vs={class:"flex-1 min-w-0"},Ls={class:"flex items-center space-x-3"},Os={class:"text-right"},Ms=["aria-expanded","aria-label"],Us=["id","aria-label"],Ds={class:"p-4 md:p-5 space-y-4"},qs={__name:"ChecklistSeoChecklist",props:{currentProjectId:{type:String,default:"default"},checklistType:{type:String,default:"web-prelaunch"}},emits:["categories-loaded"],setup(o,{expose:f,emit:n}){const{t:l}=xe(),u=n,{locale:v}=xe(),m=de(),p=o,{getAllCategories:d,getCategoryData:c,setChecklistType:w,waitForData:A}=Le(p.checklistType),{currentUser:_}=me(),x=b([]),V=b(new Set),L=b(new Set),O=b(new Set),E=b(!0),I=U(()=>x.value.reduce((y,j)=>y+(j.items?.length||0),0));U(()=>m.getProjectScores(p.currentProjectId).completedItems);const C=U(()=>m.getProjectScores(p.currentProjectId).percentage),S=U(()=>x.value.length>0&&x.value.every(y=>R(y))),h=U(()=>x.value.length),r=async()=>{try{E.value=!0,await A();const y=d();x.value=y.map(j=>{const D=c(j),k=l(`categories.${j}.name`),G=l(`categories.${j}.description`);return{id:j,name:k,description:G,items:D.items,icon:T(j),isLoading:!1}}),await Z(),u("categories-loaded",x.value)}catch{x.value=[]}finally{E.value=!1}},a=()=>{window.dataLayer&&window.dataLayer.push({event:"deployment_ready",category:"checklist",action:"deploy_click",label:"all_categories_completed"})},T=y=>({seo:"fluent-emoji:magnifying-glass-tilted-left",accessibilite:"fluent-emoji:wheelchair-symbol",performance:"fluent-emoji:high-voltage","eco-conception":"fluent-emoji:seedling","responsive-ux":"fluent-emoji:mobile-phone",securite:"fluent-emoji:locked",analytics:"fluent-emoji:bar-chart","reseau-chiffrement":"fluent-emoji:shield","authentification-acces":"fluent-emoji:key","protection-attaques":"fluent-emoji:crossed-swords","fichiers-donnees":"fluent-emoji:file-folder","maintenance-surveillance":"fluent-emoji:eye","app-store":"fluent-emoji:red-apple","play-store":"fluent-emoji:robot",technical:"fluent-emoji:gear",legal:"fluent-emoji:balance-scale"})[y]||"fluent-emoji:clipboard",P=async()=>{try{if(!_.value||!p.currentProjectId){V.value=new Set;return}await m.loadProjectChecked(_.value.uid,p.currentProjectId),V.value=m.getCheckedSet(p.currentProjectId)}catch{V.value=new Set}},M=async()=>{try{if(!_.value||!p.currentProjectId)return;m.setCheckedForProject(p.currentProjectId,V.value),await m.saveProjectChecked(_.value.uid,p.currentProjectId),await Z()}catch{}},Z=async()=>{try{if(!p.currentProjectId)return;const y=[];x.value.forEach(j=>{j.items&&y.push(...j.items)}),m.calculateScoresFromItems(p.currentProjectId,y,V.value)}catch(y){console.error("Erreur lors du calcul des scores:",y)}},J=async y=>{try{if(!_.value||!y.detail?.projectId)return;await P(),await r(),await Z()}catch(j){console.error("Erreur lors du changement de projet:",j)}},ae=async y=>{try{if(!_.value||!p.currentProjectId)return;await m.loadProjectChecked(_.value.uid,p.currentProjectId),V.value=m.getCheckedSet(p.currentProjectId),await Z()}catch(j){console.error("Erreur lors de la mise à jour des éléments cochés:",j)}},$e=y=>O.value.has(y),he=y=>{O.value.add(y)},Ce=y=>{O.value.delete(y)},je=y=>{he(y)},Se=y=>{Ce(y)},Pe=async y=>{const j=V.value.has(y);j?V.value.delete(y):V.value.add(y),await M();const D=x.value.find(k=>k.items?.some(G=>G.id===y));if(D){if(!j&&R(D))re(()=>{fe(D.id)}),L.value.delete(D.id);else if(j&&!R(D))L.value.add(D.id);else if(!j){const k=D.items.findIndex(G=>G.id===y);if(k!==-1&&k<D.items.length-1){const G=D.items[k+1];$e(y)&&G&&!ce(G.id)&&(L.value.has(D.id)||L.value.add(D.id),re(()=>{he(G.id),window.dispatchEvent(new CustomEvent("open-item-accordion",{detail:{itemId:G.id}}))}))}}}},ce=y=>V.value.has(y),R=y=>!y.items||y.items.length===0?!1:y.items.every(j=>ce(j.id)),Ie=b(null);U(()=>{const y=[];for(let j=0;j<12;j++)y.push({id:j,angle:j/12*360,delay:j*40,distance:80+Math.random()*40});return y});const fe=y=>{Ie.value=y},Q=y=>L.value.has(y),Ee=y=>y.items?y.items.filter(j=>ce(j.id)).length:0,ve=y=>{if(L.value.has(y)){L.value.delete(y);const j=x.value.find(D=>D.id===y);j&&j.items&&j.items.forEach(D=>{window.dispatchEvent(new CustomEvent("close-item-accordion",{detail:{itemId:D.id}}))})}else x.value.forEach(j=>{j.items&&j.items.forEach(D=>{window.dispatchEvent(new CustomEvent("close-item-accordion",{detail:{itemId:D.id}}))})}),L.value.clear(),L.value.add(y),R(x.value.find(j=>j.id===y))&&fe(y)},pe=y=>{x.value.forEach(j=>{j.items&&j.items.forEach(D=>{window.dispatchEvent(new CustomEvent("close-item-accordion",{detail:{itemId:D.id}}))})}),L.value.clear(),L.value.add(y)};return oe(C,y=>{window.dispatchEvent(new CustomEvent("progress-updated",{detail:{percentage:Math.round(y)}}))},{immediate:!0}),oe(v,async()=>{await r()},{immediate:!1}),oe(()=>p.checklistType,async y=>{w(y),await r()},{immediate:!1}),oe(()=>p.currentProjectId,async(y,j)=>{if(y&&y!==j)try{await P(),await Z()}catch(D){console.error("Erreur lors du changement de projet (watcher):",D)}},{immediate:!1}),ne(()=>{re().then(async()=>{await P(),await r(),x.value.length>0&&L.value.add(x.value[0].id),window.addEventListener("open-category",y=>{y.detail&&y.detail.categoryId&&pe(y.detail.categoryId)}),window.addEventListener("project-checklist-changed",J),window.addEventListener("checked-items-updated",ae)})}),ie(()=>{window.removeEventListener("open-category",y=>{y.detail&&y.detail.categoryId&&pe(y.detail.categoryId)}),window.removeEventListener("project-checklist-changed",J),window.removeEventListener("checked-items-updated",ae)}),f({openCategory:pe,resetProgress:async()=>{V.value=new Set,_.value&&p.currentProjectId&&(m.setCheckedForProject(p.currentProjectId,new Set),m.resetProjectScores(p.currentProjectId),await m.saveProjectChecked(_.value.uid,p.currentProjectId)),window.dispatchEvent(new CustomEvent("progress-updated",{detail:{percentage:0}}))}}),(y,j)=>{const D=X;return t(),s("div",js,[S.value&&!E.value?(t(),W(ks,{key:0,"total-items":I.value,"total-categories":h.value,onDeployClick:a},null,8,["total-items","total-categories"])):g("",!0),e("div",Ss,[E.value?(t(),s(z,{key:0},N(3,k=>$(ws,{key:`skeleton-category-${k}`})),64)):(t(!0),s(z,{key:1},N(x.value,(k,G)=>(t(),s("div",{key:k.id,class:"card",role:"region","aria-label":`Catégorie ${k.name}`},[e("div",{class:q(["p-4 md:p-5 cursor-pointer transition-all duration-300 hover:bg-opacity-80 relative overflow-hidden",{"bg-gradient-to-br from-green-400 to-green-600 shadow-lg shadow-green-500/30 rounded-t-xl":R(k)&&Q(k.id),"bg-gradient-to-br from-green-400 to-green-600 shadow-lg shadow-green-500/30 rounded-xl":R(k)&&!Q(k.id),"hover:bg-opacity-80 rounded-t-xl":!R(k)&&Q(k.id),"hover:bg-opacity-80 rounded-xl":!R(k)&&!Q(k.id)}]),onClick:ee=>ve(k.id),onKeydown:[se(ee=>ve(k.id),["enter"]),se(Y(ee=>ve(k.id),["prevent"]),["space"])],role:"button","aria-expanded":Q(k.id),"aria-controls":`category-${k.id}`,"aria-label":`${Q(k.id)?te(l)("common.closeCategory",{name:k.name}):te(l)("common.openCategory",{name:k.name})}`,tabindex:"0"},[e("div",Es,[e("div",As,[e("div",Ts,[$(D,{name:T(k.id),class:q(["w-8 h-8 transition-colors duration-200",{"text-white drop-shadow-sm":R(k)}]),style:B({color:R(k)?"white":"var(--accent-primary)"}),"aria-hidden":"true"},null,8,["name","class","style"])]),e("div",Vs,[e("h2",{class:q(["text-xl font-semibold leading-tight transition-colors duration-200 mb-1",{"text-white":R(k)}]),style:B({color:R(k)?"white":"var(--text-primary)"})},i(k.name),7),e("p",{class:q(["text-sm transition-colors duration-200",{"text-green-100":R(k)}]),style:B({color:R(k)?"#dcfce7":"var(--text-secondary)"})},i(k.description),7)])]),e("div",Ls,[e("div",Os,[e("div",{class:q(["text-sm font-medium transition-colors duration-200",{"text-white":R(k)}]),style:B({color:R(k)?"white":"var(--text-primary)"})},i(Ee(k))+" / "+i(k.items?.length||0),7),e("div",{class:q(["text-xs transition-colors duration-200",{"text-green-100":R(k)}]),style:B({color:R(k)?"#dcfce7":"var(--text-muted)"})},i(te(l)("common.completed")),7)]),e("button",{class:q(["flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center transition-all duration-200 hover:bg-opacity-80",{"rotate-180":Q(k.id)&&!R(k),"bg-white/20 hover:bg-white/30":R(k)}]),"aria-expanded":Q(k.id),"aria-label":`${Q(k.id)?te(l)("common.closeCategory",{name:k.name}):te(l)("common.openCategory",{name:k.name})}`,"aria-hidden":"true"},[R(k)?(t(),W(D,{key:0,name:"heroicons:check-circle",class:"w-6 h-6 transition-colors duration-200 text-white","aria-hidden":"true"})):(t(),W(D,{key:1,name:"heroicons:chevron-down",class:"w-5 h-5 transition-colors duration-200",style:{color:"var(--text-muted)"},"aria-hidden":"true"}))],10,Ms)])])],42,Is),e("div",{id:`category-${k.id}`,class:q(["border-t transition-all duration-500 ease-out overflow-hidden",{"max-h-0 opacity-0 transform -translate-y-2":!Q(k.id),"max-h-[10000px] opacity-100 transform translate-y-0":Q(k.id)}]),style:{"border-color":"var(--bg-border)","background-color":"var(--bg-primary)"},role:"region","aria-label":`Contenu de la catégorie ${k.name}`},[e("div",Ds,[k.isLoading?(t(),s(z,{key:0},N(3,ee=>$(Cs,{key:`skeleton-item-${ee}`})),64)):(t(!0),s(z,{key:1},N(k.items,ee=>(t(),W(fs,{key:ee.id,item:ee,"is-item-checked":ce(ee.id),onToggleItem:Pe,onAccordionOpened:je,onAccordionClosed:Se},null,8,["item","is-item-checked"]))),128))])],10,Us)],8,Ps))),128))])])}}},Rs=ue(qs,[["__scopeId","data-v-1fa2ff20"]]),zs={class:"flex gap-2"},Ns={class:"flex-1"},Bs={key:0,class:"text-sm text-red-500 mt-1"},Fs=["open"],Hs={class:"flex items-center gap-2"},Xs={class:"px-4 pb-4"},Ks={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Zs={class:"relative"},Ws=["type"],Js=["title","aria-label"],Qs={class:"flex items-center gap-3"},Gs=["disabled"],Ys={key:0},eo={key:1,class:"flex items-center gap-2"},to={key:2,class:"flex items-center gap-2"},so={key:3,class:"inline-flex items-center gap-2"},oo={class:"animate-spin h-4 w-4",viewBox:"0 0 24 24",style:{color:"white"}},lo={key:0,class:"text-sm",style:{color:"#fca5a5"}},ao={key:0,class:"mt-8 space-y-6"},ro={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},no={class:"w-16 h-16 rounded-full grid place-items-center",style:{"background-color":"var(--bg-surface)",border:"1px solid var(--bg-border)"}},io={class:"text-lg font-bold",style:{color:"var(--text-primary)"}},co={class:"text-sm font-semibold",style:{color:"var(--text-primary)"}},uo={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},mo={class:"p-4 rounded-xl border",style:{"border-color":"var(--bg-border)"}},vo={class:"space-y-2 text-sm"},po={class:"flex items-center gap-2"},yo={class:"flex items-center gap-2"},ho={class:"flex items-center gap-2"},fo={class:"flex items-center gap-2"},xo={class:"p-4 rounded-xl border",style:{"border-color":"var(--bg-border)"}},bo={class:"space-y-2 text-sm",style:{color:"var(--text-secondary)"}},go=le({__name:"LighthousePanel",emits:["items-autochecked"],setup(o,{expose:f,emit:n}){const l=b(""),u=b(""),v=b(""),m=b(!1),p=b("mobile"),d=b(!1),c=b(""),w=b(null),A=n,_=b(!1),x=b(!1),V=[{key:"performance",label:"Performance"},{key:"seo",label:"SEO"},{key:"best-practices",label:"Bonnes pratiques"},{key:"accessibility",label:"Accessibilité"}],L=r=>r!=null?Math.round(r*100):0,O=r=>({background:`conic-gradient(var(--accent-primary) ${r*3.6}deg, var(--bg-border) 0)`}),E=r=>{const a=w.value?.audits?.[r]?.numericValue;return a!=null?`${Math.round(a)} ms`:"—"},I=r=>{const a=w.value?.audits?.[r];return a?a.score===1?"OK":"À améliorer":"—"},C=async()=>{if(!l.value||!x.value){c.value="Veuillez entrer une URL valide";return}c.value="",w.value=null,d.value=!0;try{const r={url:l.value,formFactor:p.value};u.value&&v.value&&(r.basicUser=u.value,r.basicPass=v.value);const a=await $fetch("/.netlify/functions/lh",{method:"POST",body:r});w.value=a;try{const{collectChecklistItemIdsFromLhr:T}=await Ve(async()=>{const{collectChecklistItemIdsFromLhr:M}=await import("./Di7wLZl5.js");return{collectChecklistItemIdsFromLhr:M}},[],import.meta.url),P=T(w.value);P.length>0&&A("items-autochecked",P)}catch{}}catch(r){c.value=r?.data?.statusMessage||r?.message||"Erreur inattendue"}finally{d.value=!1}},S=()=>{if(!l.value){x.value=!1;return}try{const r=new URL(l.value);if(!["http:","https:"].includes(r.protocol)){x.value=!1;return}if(!r.hostname||r.hostname.length<3){x.value=!1;return}if(!r.hostname.includes(".")){x.value=!1;return}x.value=!0}catch{x.value=!1}};return f({reset:()=>{l.value="",u.value="",v.value="",m.value=!1,p.value="mobile",d.value=!1,c.value="",w.value=null,_.value=!1,x.value=!1}}),(r,a)=>{const T=X;return t(),s("div",null,[e("form",{onSubmit:Y(C,["prevent"]),class:"space-y-4",autocomplete:"off"},[e("div",null,[a[7]||(a[7]=e("label",{class:"block text-sm mb-1",style:{color:"var(--text-secondary)"}},"URL",-1)),e("div",zs,[e("div",Ns,[F(e("input",{"onUpdate:modelValue":a[0]||(a[0]=P=>l.value=P),type:"url",required:"",placeholder:"https://preprod.example.com",class:q(["input w-full",{"border-red-500":l.value&&!x.value}]),autocomplete:"off",spellcheck:"false",autocapitalize:"none",onInput:S},null,34),[[H,l.value]]),l.value&&!x.value?(t(),s("div",Bs," Veuillez entrer une URL valide (ex: https://example.com) ")):g("",!0)]),F(e("select",{"onUpdate:modelValue":a[1]||(a[1]=P=>p.value=P),class:"input w-36"},a[6]||(a[6]=[e("option",{value:"mobile"},"Mobile",-1),e("option",{value:"desktop"},"Desktop",-1)]),512),[[Ae,p.value]])])]),e("details",{class:"rounded-xl border",style:{"border-color":"var(--bg-border)"},open:_.value},[e("summary",{class:"cursor-pointer px-4 py-3 text-sm flex items-center justify-between",onClick:a[2]||(a[2]=Y(P=>_.value=!_.value,["prevent"])),style:{color:"var(--text-secondary)"}},[e("span",Hs,[$(T,{name:"heroicons:adjustments-vertical",class:"w-4 h-4"}),a[8]||(a[8]=K(" Options avancées",-1))]),$(T,{name:_.value?"heroicons:chevron-up":"heroicons:chevron-down",class:"w-4 h-4"},null,8,["name"])]),e("div",Xs,[e("div",Ks,[e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm mb-1",style:{color:"var(--text-secondary)"}},"HTTP Basic – user",-1)),F(e("input",{"onUpdate:modelValue":a[3]||(a[3]=P=>u.value=P),type:"text",placeholder:"user",class:"input w-full",autocomplete:"off",spellcheck:"false",autocapitalize:"none"},null,512),[[H,u.value]])]),e("div",null,[a[10]||(a[10]=e("label",{class:"block text-sm mb-1",style:{color:"var(--text-secondary)"}},"HTTP Basic – password",-1)),e("div",Zs,[F(e("input",{"onUpdate:modelValue":a[4]||(a[4]=P=>v.value=P),type:m.value?"text":"password",placeholder:"mot de passe",class:"input w-full pr-12",autocomplete:"new-password"},null,8,Ws),[[Te,v.value]]),e("button",{type:"button",onClick:a[5]||(a[5]=P=>m.value=!m.value),class:"absolute inset-y-0 right-2 my-auto w-9 h-9 rounded-lg flex items-center justify-center",title:m.value?"Cacher":"Afficher","aria-label":m.value?"Cacher":"Afficher",style:{"background-color":"transparent"}},[$(T,{name:m.value?"heroicons:eye-slash":"heroicons:eye",class:"w-5 h-5",style:{color:"var(--text-primary)"}},null,8,["name"])],8,Js)])])])])],8,Fs),e("div",Qs,[e("button",{disabled:d.value||!l.value||!x.value,class:q(["btn btn-primary",{"opacity-50 cursor-not-allowed":!l.value||!x.value}])},[!d.value&&l.value&&x.value?(t(),s("span",Ys,"Lancer l'audit")):!d.value&&!l.value?(t(),s("span",eo,[$(T,{name:"heroicons:information-circle",class:"w-4 h-4"}),a[11]||(a[11]=K(" Entrez l'URL du site web ",-1))])):!d.value&&!x.value?(t(),s("span",to,[$(T,{name:"heroicons:information-circle",class:"w-4 h-4"}),a[12]||(a[12]=K(" URL invalide ",-1))])):(t(),s("span",so,[(t(),s("svg",oo,a[13]||(a[13]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)]))),a[14]||(a[14]=K(" Audit en cours… ",-1))]))],10,Gs),c.value?(t(),s("span",lo,i(c.value),1)):g("",!0)])],32),w.value?(t(),s("div",ao,[e("div",ro,[(t(),s(z,null,N(V,P=>e("div",{key:P.key,class:"p-4 rounded-xl border text-center",style:{"border-color":"var(--bg-border)"}},[e("div",{class:"mx-auto mb-3 w-20 h-20 rounded-full grid place-items-center",style:B(O(L(w.value.categories[P.key]?.score)))},[e("div",no,[e("span",io,i(L(w.value.categories[P.key]?.score)),1)])],4),e("div",co,i(P.label),1)])),64))]),e("div",uo,[e("div",mo,[a[19]||(a[19]=e("h3",{class:"font-semibold mb-3",style:{color:"var(--text-primary)"}},"Indicateurs clés",-1)),e("ul",vo,[e("li",po,[$(T,{name:"heroicons:clock",class:"w-4 h-4",style:{color:"var(--accent-primary)"}}),a[15]||(a[15]=e("span",{class:"flex-1"},"LCP",-1)),e("strong",null,i(E("largest-contentful-paint")),1)]),e("li",yo,[$(T,{name:"heroicons:cursor-arrow-rays",class:"w-4 h-4",style:{color:"var(--accent-primary)"}}),a[16]||(a[16]=e("span",{class:"flex-1"},"INP",-1)),e("strong",null,i(E("experimental-interaction-to-next-paint")),1)]),e("li",ho,[$(T,{name:"heroicons:arrows-right-left",class:"w-4 h-4",style:{color:"var(--accent-primary)"}}),a[17]||(a[17]=e("span",{class:"flex-1"},"CLS",-1)),e("strong",null,i(w.value?.audits?.["cumulative-layout-shift"]?.displayValue??"—"),1)]),e("li",fo,[$(T,{name:"heroicons:signal",class:"w-4 h-4",style:{color:"var(--accent-primary)"}}),a[18]||(a[18]=e("span",{class:"flex-1"},"TTFB",-1)),e("strong",null,i(E("server-response-time")),1)])])]),e("div",xo,[a[23]||(a[23]=e("h3",{class:"font-semibold mb-3",style:{color:"var(--text-primary)"}},"Détails SEO",-1)),e("ul",bo,[e("li",null,[a[20]||(a[20]=K("Titres & meta: ",-1)),e("strong",null,i(I("meta-description")),1)]),e("li",null,[a[21]||(a[21]=K("Liens internes: ",-1)),e("strong",null,i(I("is-crawlable")),1)]),e("li",null,[a[22]||(a[22]=K("Best practices: ",-1)),e("strong",null,i(I("image-alt")),1)])])])]),a[24]||(a[24]=e("p",{class:"text-xs",style:{color:"var(--text-muted)"}},"Astuce: lancez l’audit sur mobile et desktop pour comparer.",-1))])):g("",!0)])}}}),ko=Object.assign(go,{__name:"DashboardLighthousePanel"}),_o={class:"card",style:{"background-color":"var(--bg-surface)",border:"1px solid var(--bg-border)"}},wo=["disabled","aria-expanded"],$o={class:"flex items-center gap-3"},Co={class:"w-8 h-8 rounded-lg flex items-center justify-center",style:{"background-color":"var(--bg-primary)",border:"1px solid var(--bg-border)"}},jo={class:"text-left"},So={class:"text-xs",style:{color:"var(--text-secondary)"}},Po={class:"p-4"},Io=le({__name:"LighthouseAccordion",props:{defaultExpanded:{type:Boolean},projectType:{}},setup(o,{expose:f}){const n=o,{currentUser:l}=me(),u=de(),v=b(n.defaultExpanded??!0),m=b();oe(()=>n.projectType,A=>{A==="appstore-preflight"||A==="security-checker"?v.value=!1:n.defaultExpanded&&(v.value=!0)},{immediate:!0});const p=()=>{v.value=!1},d=async()=>{v.value=!1,await re(),m.value&&m.value.reset()},c=()=>{n.projectType==="appstore-preflight"||n.projectType==="security-checker"||(v.value=!v.value)},w=async A=>{try{const _=u.currentProjectId;if(!_||!l?.value)return;const x=u.getCheckedSet(_);A.forEach(V=>x.add(V)),u.setCheckedForProject(_,x),await u.saveProjectChecked(l.value.uid,_),window.dispatchEvent(new CustomEvent("checked-items-updated",{detail:{projectId:_,itemIds:A}}))}catch{}};return f({close:p,reset:d,expanded:U(()=>v.value)}),(A,_)=>{const x=X;return t(),s("div",_o,[e("button",{onClick:c,disabled:A.projectType==="appstore-preflight",class:q(["w-full p-4 flex items-center justify-between rounded-xl transition-all duration-300",[A.projectType==="appstore-preflight"?"opacity-50 cursor-not-allowed":"hover:bg-opacity-80"]]),"aria-expanded":v.value,"aria-controls":"lh-content",style:{"background-color":"var(--bg-surface)"}},[e("div",$o,[e("div",Co,[$(x,{name:"heroicons:bolt",class:"w-4 h-4",style:{color:"var(--accent-primary)"}})]),e("div",jo,[_[0]||(_[0]=e("div",{class:"text-base font-semibold",style:{color:"var(--text-primary)"}},"Audit Lighthouse",-1)),e("div",So,i(A.projectType==="appstore-preflight"?"Non disponible pour les projets mobiles":A.projectType==="security-checker"?"Non disponible pour les projets de sécurité":"Analyse rapide d'une URL (mobile/desktop)"),1)])]),$(x,{name:v.value?"heroicons:chevron-up":"heroicons:chevron-down",class:"w-5 h-5",style:{color:"var(--text-muted)"}},null,8,["name"])],10,wo),e("div",{id:"lh-content",class:q(["border-t transition-all duration-500 ease-out overflow-hidden",{"max-h-0 opacity-0 -translate-y-1":!v.value,"max-h-[5000px] opacity-100 translate-y-0":v.value}]),style:{"border-color":"var(--bg-border)","background-color":"var(--bg-primary)"}},[e("div",Po,[$(ko,{ref_key:"lighthousePanel",ref:m,onItemsAutochecked:w},null,512)])],2)])}}}),ge=Object.assign(Io,{__name:"DashboardLighthouseAccordion"}),Eo={"content-security-policy":["content-security-policy"],"x-frame-options":["security-headers"],"x-content-type-options":["security-headers"],"x-xss-protection":["security-headers"],"strict-transport-security":["hsts-enabled"],"referrer-policy":["security-headers"],"permissions-policy":["security-headers"],"cross-origin-embedder-policy":["security-headers"],"cross-origin-opener-policy":["security-headers"],"cross-origin-resource-policy":["security-headers"]},Ao={xss:["xss-protection"],csrf:["csrf-protection"],injection:["sql-injection-protection"],"error-handling":["secure-error-handling"],"input-validation":["input-validation"],"file-upload":["secure-file-upload"],authentication:["secure-authentication"],"session-management":["secure-session-management"]};function we(o){const f=[];return Object.entries(o).forEach(([n,l])=>{if(l!==null){const u=Eo[n]||[];f.push(...u)}}),o["content-security-policy"]&&o["x-frame-options"]&&f.push("basic-security-headers"),o["strict-transport-security"]&&f.push("https-enforcement"),[...new Set(f)]}function To(o){const f=[];return!o||!o.vulnerabilities?f:(o.vulnerabilities.forEach(n=>{const l=n.type||n.name||"",u=Ao[l.toLowerCase()]||[];f.push(...u)}),[...new Set(f)])}const Vo=["open"],Lo={class:"flex items-center gap-3"},Oo={key:0,class:"flex items-center gap-2"},Mo={class:"text-xs font-bold text-white"},Uo={class:"flex items-center gap-2"},Do={key:0,class:"text-xs",style:{color:"var(--text-secondary)"}},qo={class:"px-4 pb-4"},Ro={class:"space-y-4"},zo={class:"flex items-center gap-3"},No=["disabled"],Bo={key:0},Fo={key:1,class:"inline-flex items-center gap-2"},Ho={key:0,class:"text-sm",style:{color:"#fca5a5"}},Xo={key:0,class:"space-y-4"},Ko={class:"p-3 rounded-lg border",style:{"background-color":"var(--bg-surface)","border-color":"var(--bg-border)"}},Zo={class:"flex items-center justify-between mb-2"},Wo={class:"text-sm font-bold text-white"},Jo={class:"text-xs",style:{color:"var(--text-secondary)"}},Qo={class:"space-y-3"},Go={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Yo={class:"flex items-center justify-between mb-1"},el={class:"text-xs font-medium",style:{color:"var(--text-primary)"}},tl={class:"flex items-center gap-1"},sl={class:"text-xs",style:{color:"var(--text-secondary)"}},ol={key:0,class:"text-xs mt-1 font-mono",style:{color:"var(--text-muted)"}},ll={key:0,class:"p-3 rounded-lg",style:{"background-color":"var(--bg-surface)"}},al={class:"space-y-1"},rl={style:{color:"var(--text-secondary)"}},nl=le({__name:"HeadersSecurityPanel",props:{url:{},isValidUrl:{type:Boolean}},emits:["items-autochecked"],setup(o,{expose:f,emit:n}){const l=o,u=n,v=b(!1),m=b(!1),p=b(""),d=b(null),c=U(()=>{if(d.value)return Math.round(d.value.score*100)}),w=U(()=>!!d.value),A=U(()=>d.value?.headers?[{name:"Content-Security-Policy",status:d.value.headers["content-security-policy"]?"present":"missing",description:"Protection contre les attaques XSS et injection",value:d.value.headers["content-security-policy"]},{name:"X-Frame-Options",status:d.value.headers["x-frame-options"]?"present":"missing",description:"Protection contre le clickjacking",value:d.value.headers["x-frame-options"]},{name:"X-Content-Type-Options",status:d.value.headers["x-content-type-options"]?"present":"missing",description:"Prévention du MIME sniffing",value:d.value.headers["x-content-type-options"]},{name:"X-XSS-Protection",status:d.value.headers["x-xss-protection"]?"present":"missing",description:"Protection XSS du navigateur",value:d.value.headers["x-xss-protection"]},{name:"Strict-Transport-Security",status:d.value.headers["strict-transport-security"]?"present":"missing",description:"Forcer HTTPS",value:d.value.headers["strict-transport-security"]},{name:"Referrer-Policy",status:d.value.headers["referrer-policy"]?"present":"missing",description:"Contrôle des informations de référence",value:d.value.headers["referrer-policy"]}]:[]),_=U(()=>{const I=[];return d.value?.headers["content-security-policy"]||I.push("Ajouter un Content-Security-Policy pour protéger contre les attaques XSS"),d.value?.headers["x-frame-options"]||I.push("Configurer X-Frame-Options pour prévenir le clickjacking"),d.value?.headers["strict-transport-security"]||I.push("Implémenter HSTS pour forcer l'utilisation de HTTPS"),I}),x=async()=>{if(!(!l.url||!l.isValidUrl)){m.value=!0,p.value="",d.value=null;try{const I=await $fetch("/api/security-headers",{method:"POST",body:{url:l.url}});if(I.success){const C=I.data,S=C.score/100;d.value={score:S,headers:C.headers,analysis:C.analysis,recommendations:C.recommendations};const h=V();h.length>0&&u("items-autochecked",h)}else throw new Error("Erreur lors du scan des headers de sécurité")}catch(I){p.value=I?.message||"Erreur lors du scan des headers de sécurité"}finally{m.value=!1}}},V=()=>d.value?we(d.value.headers||{}):[],L=I=>I>=90?"Excellent - Tous les headers de sécurité sont configurés":I>=70?"Bon - La plupart des headers de sécurité sont présents":I>=50?"Moyen - Certains headers de sécurité manquent":"Faible - Beaucoup de headers de sécurité sont manquants",O=I=>({background:`conic-gradient(var(--accent-primary) ${I*3.6}deg, var(--bg-border) 0)`});return f({runScan:x,reset:()=>{m.value=!1,p.value="",d.value=null,v.value=!1},loading:m,score:c,hasResults:w}),(I,C)=>{const S=X;return t(),s("details",{class:"rounded-xl border",style:{"border-color":"var(--bg-border)"},open:v.value},[e("summary",{class:"cursor-pointer px-4 py-3 text-sm flex items-center justify-between hover:bg-opacity-50",style:{"background-color":"var(--bg-surface)"},onClick:C[0]||(C[0]=Y(h=>v.value=!v.value,["prevent"]))},[e("div",Lo,[$(S,{name:"heroicons:shield-check",class:"w-5 h-5",style:{color:"var(--accent-primary)"}}),C[1]||(C[1]=e("span",{class:"font-semibold",style:{color:"var(--text-primary)"}},"Headers de Sécurité",-1)),c.value!==void 0?(t(),s("div",Oo,[e("div",{class:"w-6 h-6 rounded-full grid place-items-center",style:B(O(c.value))},[e("span",Mo,i(c.value),1)],4)])):g("",!0)]),e("div",Uo,[m.value?(t(),s("span",Do,"Scan en cours...")):g("",!0),$(S,{name:v.value?"heroicons:chevron-up":"heroicons:chevron-down",class:"w-4 h-4",style:{color:"var(--text-secondary)"}},null,8,["name"])])]),e("div",qo,[e("div",Ro,[C[6]||(C[6]=e("p",{class:"text-sm",style:{color:"var(--text-secondary)"}}," Analyse des en-têtes HTTP de sécurité pour détecter les vulnérabilités et bonnes pratiques. ",-1)),e("div",zo,[e("button",{onClick:x,disabled:m.value||!I.isValidUrl||!I.url,class:q(["btn btn-primary btn-sm",{"opacity-50 cursor-not-allowed":!I.isValidUrl||!I.url}])},[m.value?(t(),s("span",Fo,C[2]||(C[2]=[e("svg",{class:"animate-spin h-4 w-4",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1),K(" Scan... ",-1)]))):(t(),s("span",Bo,"Scanner les headers"))],10,No),p.value?(t(),s("span",Ho,i(p.value),1)):g("",!0)]),d.value?(t(),s("div",Xo,[e("div",Ko,[e("div",Zo,[C[3]||(C[3]=e("span",{class:"text-sm font-semibold",style:{color:"var(--text-primary)"}},"Score global",-1)),e("div",{class:"w-12 h-12 rounded-full grid place-items-center",style:B(O(c.value))},[e("span",Wo,i(c.value),1)],4)]),e("div",Jo,i(L(c.value)),1)]),e("div",Qo,[C[4]||(C[4]=e("h4",{class:"text-sm font-semibold",style:{color:"var(--text-primary)"}},"Détails des headers",-1)),e("div",Go,[(t(!0),s(z,null,N(A.value,h=>(t(),s("div",{key:h.name,class:"p-3 rounded-lg border",style:B({borderColor:h.status==="present"?"var(--accent-primary)":"var(--bg-border)"})},[e("div",Yo,[e("span",el,i(h.name),1),e("div",tl,[$(S,{name:h.status==="present"?"heroicons:check-circle":"heroicons:x-circle",class:"w-4 h-4",style:B({color:h.status==="present"?"var(--accent-primary)":"#fca5a5"})},null,8,["name","style"])])]),e("div",sl,i(h.description),1),h.value?(t(),s("div",ol,i(h.value),1)):g("",!0)],4))),128))])]),_.value.length>0?(t(),s("div",ll,[C[5]||(C[5]=e("h4",{class:"text-sm font-semibold mb-2",style:{color:"var(--text-primary)"}},"Recommandations",-1)),e("ul",al,[(t(!0),s(z,null,N(_.value,h=>(t(),s("li",{key:h,class:"text-xs flex items-start gap-2"},[$(S,{name:"heroicons:information-circle",class:"w-3 h-3 mt-0.5 flex-shrink-0",style:{color:"var(--accent-primary)"}}),e("span",rl,i(h),1)]))),128))])])):g("",!0)])):g("",!0)])])],8,Vo)}}}),il=Object.assign(nl,{__name:"DashboardHeadersSecurityPanel"}),cl=["open"],dl={class:"flex items-center gap-3"},ul={key:0,class:"flex items-center gap-2"},ml={class:"text-xs font-bold text-white"},vl={class:"flex items-center gap-2"},pl={key:0,class:"text-xs",style:{color:"var(--text-secondary)"}},yl={class:"px-4 pb-4"},hl={class:"space-y-4"},fl={class:"flex items-center gap-3"},xl=["disabled"],bl={key:0},gl={key:1,class:"inline-flex items-center gap-2"},kl={key:0,class:"text-sm",style:{color:"#fca5a5"}},_l={key:0,class:"space-y-4 mt-6"},wl={class:"flex items-center justify-between mb-3"},$l={class:"text-sm",style:{color:"var(--text-secondary)"}},Cl={class:"text-lg font-bold text-white"},jl={class:"flex items-center gap-2 text-xs",style:{color:"var(--text-secondary)"}},Sl={class:"p-4 rounded-lg border",style:{"border-color":"var(--bg-border)"}},Pl={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},Il={class:"text-center p-3 rounded-lg",style:{"background-color":"#ef4444",color:"white"}},El={class:"text-lg font-bold"},Al={class:"text-center p-3 rounded-lg",style:{"background-color":"#f97316",color:"white"}},Tl={class:"text-lg font-bold"},Vl={class:"text-center p-3 rounded-lg",style:{"background-color":"#f59e0b",color:"white"}},Ll={class:"text-lg font-bold"},Ol={class:"text-center p-3 rounded-lg",style:{"background-color":"#3b82f6",color:"white"}},Ml={class:"text-lg font-bold"},Ul={key:0,class:"p-4 rounded-lg border",style:{"border-color":"var(--bg-border)"}},Dl={class:"space-y-3"},ql={class:"flex items-start justify-between"},Rl={class:"flex-1"},zl={class:"flex items-center gap-2 mb-1"},Nl={class:"text-sm font-medium",style:{color:"var(--text-primary)"}},Bl={class:"text-xs",style:{color:"var(--text-secondary)"}},Fl={key:1,class:"p-4 rounded-lg border",style:{"border-color":"var(--bg-border)"}},Hl={class:"space-y-2"},Xl=le({__name:"VulnerabilityPanel",props:{url:{},isValidUrl:{type:Boolean},isOpen:{type:Boolean}},emits:["update:isOpen","items-autochecked"],setup(o,{expose:f,emit:n}){const l=o,u=n,v=b(!1),m=b(null),p=b(""),d=U(()=>l.url),c=U(()=>l.isValidUrl),w=U(()=>m.value?.score||0),A=U(()=>!!m.value),_=U({get:()=>l.isOpen,set:P=>u("update:isOpen",P)}),x=U(()=>m.value?.vulnerabilities?m.value.vulnerabilities.slice(0,3):[]),V=U(()=>m.value?.recommendations?m.value.recommendations.slice(0,3):[]),L=async()=>{if(!(!c.value||!d.value)){v.value=!0;try{const P=await $fetch("/api/security-vulnerabilities",{method:"POST",body:{url:d.value}});if(P?.success){const M=P.data;m.value=M;try{const Z=To(m.value);Z.length&&u("items-autochecked",Z)}catch{}return}m.value=null}catch{m.value=null}finally{v.value=!1}}},O=async()=>{await L()},E=()=>{v.value=!1,m.value=null},I=P=>({background:`conic-gradient(${S(P)} ${P*3.6}deg, var(--bg-border) ${P*3.6}deg)`}),C=P=>P>=90?"Excellent - Aucune vulnérabilité critique détectée":P>=70?"Bon - Quelques vulnérabilités mineures détectées":P>=50?"Moyen - Vulnérabilités modérées nécessitent attention":"Faible - Vulnérabilités importantes nécessitent action immédiate",S=P=>P>=90?"#10b981":P>=70?"#3b82f6":P>=50?"#f59e0b":"#ef4444",h=()=>{if(!m.value)return"heroicons:question-mark-circle";switch(m.value.source){case"owasp-zap":return"heroicons:shield-check";case"manual-tests":return"heroicons:server";default:return"heroicons:question-mark-circle"}},r=()=>{if(!m.value)return"Inconnu";switch(m.value.source){case"owasp-zap":return"OWASP ZAP (scanner professionnel)";case"manual-tests":return"Tests manuels (vérifications automatisées)";default:return"Source inconnue"}},a=P=>m.value?.summary&&m.value.summary[P]||0,T=P=>{switch(P){case"critical":return"#ef4444";case"high":return"#f97316";case"medium":return"#f59e0b";case"low":return"#3b82f6";default:return"#6b7280"}};return f({runScan:O,reset:E,loading:v,score:w,hasResults:A}),(P,M)=>{const Z=X;return t(),s("details",{class:"rounded-xl border",style:{"border-color":"var(--bg-border)"},open:_.value},[e("summary",{class:"cursor-pointer px-4 py-3 text-sm flex items-center justify-between hover:bg-opacity-50",style:{"background-color":"var(--bg-surface)"},onClick:M[0]||(M[0]=Y(J=>_.value=!_.value,["prevent"]))},[e("div",dl,[$(Z,{name:"heroicons:shield-check",class:"w-5 h-5",style:{color:"var(--accent-primary)"}}),M[1]||(M[1]=e("span",{class:"font-semibold",style:{color:"var(--text-primary)"}},"Vulnerability Scanner",-1)),w.value!==void 0?(t(),s("div",ul,[e("div",{class:"w-6 h-6 rounded-full grid place-items-center",style:B(I(w.value))},[e("span",ml,i(w.value),1)],4)])):g("",!0)]),e("div",vl,[v.value?(t(),s("span",pl,"Scan en cours...")):g("",!0),$(Z,{name:_.value?"heroicons:chevron-up":"heroicons:chevron-down",class:"w-4 h-4",style:{color:"var(--text-secondary)"}},null,8,["name"])])]),e("div",yl,[e("div",hl,[M[3]||(M[3]=e("p",{class:"text-sm",style:{color:"var(--text-secondary)"}},"Analyse des vulnérabilités de sécurité avec OWASP ZAP et tests automatisés.",-1)),e("div",fl,[e("button",{onClick:O,disabled:v.value||!c.value||!d.value,class:q(["btn btn-primary btn-sm",{"opacity-50 cursor-not-allowed":v.value||!c.value||!d.value}])},[v.value?(t(),s("span",gl,M[2]||(M[2]=[e("svg",{class:"animate-spin h-4 w-4",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a 8 8 0 0 1 8-8v4a4 4 0 0 0-4 4H4z"})],-1),K(" Scan... ",-1)]))):(t(),s("span",bl,"Scanner les vulnérabilités"))],10,xl),p.value?(t(),s("span",kl,i(p.value),1)):g("",!0)])]),m.value?(t(),s("div",_l,[e("div",{class:"p-4 rounded-lg border-2",style:B({borderColor:S(w.value)})},[e("div",wl,[e("div",null,[M[4]||(M[4]=e("h3",{class:"text-lg font-bold",style:{color:"var(--text-primary)"}},"Score de sécurité",-1)),e("p",$l,i(C(w.value)),1)]),e("div",{class:"w-16 h-16 rounded-full grid place-items-center",style:B({backgroundColor:S(w.value)})},[e("span",Cl,i(w.value),1)],4)]),e("div",jl,[$(Z,{name:h(),class:"w-3 h-3"},null,8,["name"]),e("span",null,"Source : "+i(r()),1)])],4),e("div",Sl,[M[9]||(M[9]=e("h4",{class:"text-sm font-semibold mb-3",style:{color:"var(--text-primary)"}},"Résumé des vulnérabilités",-1)),e("div",Pl,[e("div",Il,[e("div",El,i(a("critical")),1),M[5]||(M[5]=e("div",{class:"text-xs"},"Critiques",-1))]),e("div",Al,[e("div",Tl,i(a("high")),1),M[6]||(M[6]=e("div",{class:"text-xs"},"Élevées",-1))]),e("div",Vl,[e("div",Ll,i(a("medium")),1),M[7]||(M[7]=e("div",{class:"text-xs"},"Moyennes",-1))]),e("div",Ol,[e("div",Ml,i(a("low")),1),M[8]||(M[8]=e("div",{class:"text-xs"},"Faibles",-1))])])]),x.value.length>0?(t(),s("div",Ul,[M[10]||(M[10]=e("h4",{class:"text-sm font-semibold mb-3",style:{color:"var(--text-primary)"}},"Vulnérabilités principales",-1)),e("div",Dl,[(t(!0),s(z,null,N(x.value,(J,ae)=>(t(),s("div",{key:ae,class:"p-3 rounded-lg border-l-4",style:B([{borderLeftColor:T(J.severity)},{"border-color":"var(--bg-border)","background-color":"var(--bg-surface)"}])},[e("div",ql,[e("div",Rl,[e("div",zl,[e("span",Nl,i(J.name),1),e("span",{class:"px-2 py-1 rounded text-xs font-medium text-white",style:B({backgroundColor:T(J.severity)})},i(J.severity.toUpperCase()),5)]),e("p",Bl,i(J.description),1)])])],4))),128))])])):g("",!0),V.value.length>0?(t(),s("div",Fl,[M[11]||(M[11]=e("h4",{class:"text-sm font-semibold mb-3",style:{color:"var(--text-primary)"}},"Recommandations principales",-1)),e("ul",Hl,[(t(!0),s(z,null,N(V.value,(J,ae)=>(t(),s("li",{key:ae,class:"flex items-start gap-2 text-sm",style:{color:"var(--text-secondary)"}},[$(Z,{name:"heroicons:light-bulb",class:"w-4 h-4 mt-0.5 flex-shrink-0",style:{color:"var(--accent-primary)"}}),e("span",null,i(J),1)]))),128))])])):g("",!0)])):g("",!0)])],8,cl)}}}),Kl=Object.assign(Xl,{__name:"DashboardVulnerabilityPanel"}),Zl=["open"],Wl={class:"flex items-center gap-3"},Jl={key:0,class:"flex items-center gap-2"},Ql={class:"text-xs font-bold text-white"},Gl={class:"flex items-center gap-2"},Yl={key:0,class:"text-xs",style:{color:"var(--text-secondary)"}},ea={class:"px-4 pb-4"},ta={class:"space-y-4"},sa={class:"flex items-center gap-3"},oa=["disabled"],la={key:0},aa={key:1,class:"inline-flex items-center gap-2"},ra={key:0,class:"text-sm",style:{color:"#fca5a5"}},na={key:0,class:"space-y-3"},ia={class:"p-3 rounded-lg",style:{"background-color":"var(--bg-surface)"}},ca={class:"flex items-center justify-between mb-2"},da={class:"text-sm font-bold text-white"},ua={class:"text-xs",style:{color:"var(--text-secondary)"}},ma={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},va={class:"p-3 rounded-lg border",style:{"border-color":"var(--bg-border)"}},pa={class:"text-xs mt-1",style:{color:"var(--text-primary)"}},ya={class:"p-3 rounded-lg border",style:{"border-color":"var(--bg-border)"}},ha={class:"text-xs mt-1",style:{color:"var(--text-primary)"}},fa=le({__name:"TlsSecurityPanel",props:{url:{},isValidUrl:{type:Boolean},isOpen:{type:Boolean}},emits:["update:isOpen","items-autochecked"],setup(o,{expose:f,emit:n}){const l=o,u=n,v=b(!1),m=b(""),p=b(null),d=b(l.url),c=b(l.isValidUrl),w=U(()=>p.value?.score),A=U(()=>!!p.value),_=U({get:()=>l.isOpen,set:O=>u("update:isOpen",O)}),x=async()=>{if(!(!c.value||!d.value)){v.value=!0,m.value="";try{const[O,E]=await Promise.all([$fetch("/api/security-observatory",{method:"POST",body:{url:d.value}}),$fetch("/api/security-headers",{method:"POST",body:{url:d.value}})]);if(O?.success||E?.success){const I=O?.success?O.data:null,C=E?.success?E.data:null,S=Math.round(((I?.score??0)+(C?.score??0))/2);if(p.value={score:S,observatory:I,headers:C},C?.headers)try{const h=we(C.headers);h.length&&u("items-autochecked",h)}catch{}}else throw new Error("Échec des scans")}catch(O){m.value=O?.data?.statusMessage||O?.message||"Erreur SSL",p.value=null}finally{v.value=!1}}},V=O=>({background:`conic-gradient(var(--accent-primary) ${(typeof O=="number"?O:0)*3.6}deg, var(--bg-border) 0)`});return f({runScan:x,reset:()=>{v.value=!1,m.value="",p.value=null},loading:v,score:w,hasResults:A}),(O,E)=>{const I=X;return t(),s("details",{class:"rounded-xl border",style:{"border-color":"var(--bg-border)"},open:_.value},[e("summary",{class:"cursor-pointer px-4 py-3 text-sm flex items-center justify-between hover:bg-opacity-50",style:{"background-color":"var(--bg-surface)"},onClick:E[0]||(E[0]=Y(C=>_.value=!_.value,["prevent"]))},[e("div",Wl,[$(I,{name:"heroicons:lock-closed",class:"w-5 h-5",style:{color:"var(--accent-primary)"}}),E[1]||(E[1]=e("span",{class:"font-semibold",style:{color:"var(--text-primary)"}},"SSL / TLS",-1)),w.value!==void 0?(t(),s("div",Jl,[e("div",{class:"w-6 h-6 rounded-full grid place-items-center",style:B(V(w.value))},[e("span",Ql,i(w.value),1)],4)])):g("",!0)]),e("div",Gl,[v.value?(t(),s("span",Yl,"Scan en cours...")):g("",!0),$(I,{name:_.value?"heroicons:chevron-up":"heroicons:chevron-down",class:"w-4 h-4",style:{color:"var(--text-secondary)"}},null,8,["name"])])]),e("div",ea,[e("div",ta,[E[7]||(E[7]=e("p",{class:"text-sm",style:{color:"var(--text-secondary)"}},"Analyse Observatory de Mozilla (score global) et Security Headers (présence des en-têtes).",-1)),e("div",sa,[e("button",{onClick:x,disabled:v.value||!c.value||!d.value,class:q(["btn btn-primary btn-sm",{"opacity-50 cursor-not-allowed":!c.value||!d.value}])},[v.value?(t(),s("span",aa,E[2]||(E[2]=[e("svg",{class:"animate-spin h-4 w-4",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})],-1),K(" Scan... ",-1)]))):(t(),s("span",la,"Lancer les 2 scans"))],10,oa),m.value?(t(),s("span",ra,i(m.value),1)):g("",!0)]),p.value?(t(),s("div",na,[e("div",ia,[e("div",ca,[E[3]||(E[3]=e("span",{class:"text-sm font-semibold",style:{color:"var(--text-primary)"}},"Score global",-1)),e("div",{class:"w-12 h-12 rounded-full grid place-items-center",style:B(V(w.value))},[e("span",da,i(w.value),1)],4)]),e("div",ua,[E[4]||(E[4]=K(" Mozilla Observatory: ",-1)),e("strong",null,i(p.value.observatory?.grade||"—"),1)])]),e("div",ma,[e("div",va,[E[5]||(E[5]=e("div",{class:"text-xs",style:{color:"var(--text-secondary)"}},"En-têtes de sécurité",-1)),e("ul",pa,[(t(!0),s(z,null,N(p.value.headers?.headers,(C,S)=>(t(),s("li",{key:S},[K(i(S)+": ",1),e("strong",null,i(C?"présent":"manquant"),1)]))),128))])]),e("div",ya,[E[6]||(E[6]=e("div",{class:"text-xs",style:{color:"var(--text-secondary)"}},"Recommandations",-1)),e("ul",ha,[(t(!0),s(z,null,N(p.value.headers?.recommendations||[],C=>(t(),s("li",{key:C},i(C),1))),128))])])])])):g("",!0)])])],8,Zl)}}});Object.assign(fa,{__name:"DashboardTlsSecurityPanel"});const xa={class:"space-y-4"},ba={class:"flex items-center justify-between"},ga={class:"flex items-center gap-2"},ka=["disabled"],_a={key:0},wa={key:1,class:"inline-flex items-center gap-2"},$a={class:"animate-spin h-4 w-4",viewBox:"0 0 24 24",style:{color:"white"}},Ca={class:"p-4 rounded-xl border",style:{"border-color":"var(--bg-border)","background-color":"var(--bg-surface)"}},ja={class:"flex gap-2"},Sa=["disabled"],Pa={class:"flex items-center gap-2"},Ia={key:0,class:"text-sm mt-1",style:{color:"#fca5a5"}},Ea={class:"space-y-3"},Aa={key:0,class:"p-4 rounded-xl border",style:{"border-color":"var(--bg-border)"}},Ta={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Va={class:"w-12 h-12 rounded-full grid place-items-center",style:{"background-color":"var(--bg-surface)",border:"1px solid var(--bg-border)"}},La={class:"text-sm font-bold",style:{color:"var(--text-primary)"}},Oa={class:"text-xs font-semibold",style:{color:"var(--text-primary)"}},Ma=le({__name:"SecurityScannerAccordion",emits:["items-autochecked"],setup(o,{expose:f,emit:n}){const l=n,u=b(),v=b(),m=b(),p=b(""),d=b(!1),c=b(!1),w=b(!1),A=b(!1),_=U(()=>u.value?.loading||m.value?.loading||v.value?.loading),x=U(()=>u.value?.hasResults||m.value?.hasResults||v.value?.hasResults),V=U(()=>{const h=[];return u.value?.score!==void 0&&h.push({key:"headers",label:"Headers",value:u.value.score}),v.value?.score!==void 0&&h.push({key:"vulnerabilities",label:"Vulnérabilités",value:v.value.score}),h}),L=()=>{if(!p.value){d.value=!1;return}try{const h=new URL(p.value);if(!["http:","https:"].includes(h.protocol)){d.value=!1;return}if(!h.hostname||!h.hostname.includes(".")){d.value=!1;return}d.value=!0}catch{d.value=!1}},O=async()=>{if(!p.value||!d.value)return;const h=[];u.value?.runScan&&h.push(u.value.runScan()),m.value?.runScan&&h.push(m.value.runScan()),v.value?.runScan&&h.push(v.value.runScan());try{await Promise.all(h)}catch{}},E=h=>{l("items-autochecked",h)},I=()=>{p.value="",d.value=!1,c.value=!1,w.value=!1,A.value=!1,u.value?.reset&&u.value.reset(),m.value?.reset&&m.value.reset(),v.value?.reset&&v.value.reset()},C=()=>{I()};ne(()=>{window.addEventListener("project-checklist-changed",C)}),ie(()=>{window.removeEventListener("project-checklist-changed",C)});const S=h=>({background:`conic-gradient(var(--accent-primary) ${h*3.6}deg, var(--bg-border) 0)`});return f({reset:I}),(h,r)=>{const a=X;return t(),s("div",xa,[e("div",ba,[r[5]||(r[5]=e("div",{class:"text-base font-semibold",style:{color:"var(--text-primary)"}},"Scanner de Sécurité",-1)),e("div",ga,[e("button",{onClick:O,disabled:_.value||!p.value||!d.value,class:q(["btn btn-primary btn-sm",{"opacity-50 cursor-not-allowed":!p.value||!d.value}])},[_.value?(t(),s("span",wa,[(t(),s("svg",$a,r[3]||(r[3]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)]))),r[4]||(r[4]=K(" Scan en cours... ",-1))])):(t(),s("span",_a,"Scanner complet"))],10,ka)])]),e("div",Ca,[r[7]||(r[7]=e("label",{class:"block text-sm mb-2",style:{color:"var(--text-secondary)"}},"URL à scanner",-1)),e("div",ja,[F(e("input",{"onUpdate:modelValue":r[0]||(r[0]=T=>p.value=T),type:"url",required:"",placeholder:"https://example.com",class:q(["flex-1 px-3 py-2 rounded-lg border text-sm",{"border-red-500":p.value&&!d.value}]),style:{"background-color":"var(--bg-primary)","border-color":"var(--bg-border)",color:"var(--text-primary)"},onInput:L},null,34),[[H,p.value]]),e("button",{onClick:O,disabled:_.value||!p.value||!d.value,class:q(["btn btn-primary",{"opacity-50 cursor-not-allowed":!p.value||!d.value}])},[e("div",Pa,[$(a,{name:"heroicons:shield-check",class:"w-4 h-4"}),r[6]||(r[6]=e("span",{class:"hidden sm:inline"},"Scanner tout",-1))])],10,Sa)]),r[8]||(r[8]=e("div",{class:"text-xs mt-2",style:{color:"var(--text-secondary)"}}," Cette URL sera utilisée pour tous les scans. Vous pouvez lancer l’ensemble ou chaque section séparément. ",-1)),p.value&&!d.value?(t(),s("div",Ia," Veuillez entrer une URL valide (ex: https://example.com) ")):g("",!0)]),e("div",Ea,[$(il,{ref_key:"headersPanel",ref:u,url:p.value,"is-valid-url":d.value,"is-open":c.value,"onUpdate:isOpen":r[1]||(r[1]=T=>c.value=T),onItemsAutochecked:E},null,8,["url","is-valid-url","is-open"]),$(Kl,{ref_key:"vulnerabilityPanel",ref:v,url:p.value,"is-valid-url":d.value,"is-open":A.value,"onUpdate:isOpen":r[2]||(r[2]=T=>A.value=T),onItemsAutochecked:E},null,8,["url","is-valid-url","is-open"])]),x.value?(t(),s("div",Aa,[r[9]||(r[9]=e("h3",{class:"font-semibold mb-3",style:{color:"var(--text-primary)"}},"Résumé de Sécurité",-1)),e("div",Ta,[(t(!0),s(z,null,N(V.value,T=>(t(),s("div",{key:T.key,class:"text-center"},[e("div",{class:"mx-auto mb-2 w-16 h-16 rounded-full grid place-items-center",style:B(S(T.value))},[e("div",Va,[e("span",La,i(T.value),1)])],4),e("div",Oa,i(T.label),1)]))),128))])])):g("",!0)])}}}),Ua=Object.assign(Ma,{__name:"DashboardSecurityScannerAccordion"}),Da={class:"w-full"},qa={key:0,class:"mb-2 flex items-center justify-between"},Ra={class:"text-sm font-medium text-gray-700"},za={class:"flex items-center gap-2 text-xs"},Na=["rows","placeholder","value"],Ba=le({__name:"CodeEditor",props:{modelValue:{default:""},placeholder:{default:""},label:{default:""},rows:{default:10},cleanMarkdown:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(o,{emit:f}){const n=o,l=f,u=c=>{const w=c.target.value;l("update:modelValue",w)},v=()=>l("update:modelValue",""),m=async()=>{try{await navigator.clipboard.writeText(n.modelValue||"")}catch{}},p=c=>(c||"").replace(/```[a-zA-Z]*\s*/g,"").replace(/```/g,"").trim(),d=()=>{if(!n.cleanMarkdown)return;const c=p(n.modelValue);l("update:modelValue",c)};return(c,w)=>(t(),s("div",Da,[c.label?(t(),s("div",qa,[e("label",Ra,i(c.label),1),e("div",za,[c.cleanMarkdown?(t(),s("button",{key:0,class:"btn-xs",onClick:d},"Nettoyer Markdown")):g("",!0),e("button",{class:"btn-xs",onClick:m},"Copier"),e("button",{class:"btn-xs",onClick:v},"Vider")])])):g("",!0),e("textarea",{rows:c.rows,placeholder:c.placeholder,class:"textarea font-mono",value:c.modelValue,onInput:u},null,40,Na)]))}}),ke=Object.assign(ue(Ba,[["__scopeId","data-v-f1724d2e"]]),{__name:"CommonCodeEditor"}),Fa={class:"card p-4 rounded-xl"},Ha={class:"flex gap-2 mb-4"},Xa={key:0,class:"space-y-3"},Ka={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Za={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Wa={key:0,class:"mt-3 space-y-2"},Ja={key:0,class:"p-3 rounded-md bg-emerald-50 text-emerald-800 border border-emerald-200"},Qa={key:1,class:"space-y-2"},Ga={key:0},Ya={class:"font-medium"},er={class:"list-disc ml-5"},tr={key:1},sr={class:"font-medium"},or={class:"list-disc ml-5"},lr={key:2,class:"text-xs text-gray-500"},ar={key:1,class:"space-y-3"},rr={class:"flex items-center gap-2"},nr=["disabled"],ir={key:0},cr={key:1},dr={key:0,class:"text-red-600 text-sm"},ur={key:0,class:"list-disc ml-5 mt-3"},mr={key:1,class:"p-3 rounded-md bg-emerald-50 text-emerald-800 border border-emerald-200 mt-3"},vr={key:2,class:"space-y-3"},pr={class:"flex items-center gap-2"},yr=["disabled"],hr={key:0},fr={key:1},xr={key:0,class:"text-red-600 text-sm"},br={key:0,class:"list-disc ml-5 mt-3"},gr=le({__name:"AppPreflightAccordion",setup(o,{expose:f}){const n=b("meta"),l=b({ios:{name:"",subtitle:"",keywords:"",promotionalText:"",description:"",releaseNotes:""},android:{title:"",shortDescription:"",fullDescription:"",releaseNotes:""}}),u=b(null),v=b([]),m=b([]),p=b(!1),d=b(""),c=b(null),w=b(!1),A=b(null),_=b(""),x=b(null),V=b(!1),L=b(null),O=async()=>{const h={platform:"both",data:{name:l.value.ios.name,subtitle:l.value.ios.subtitle,keywords:l.value.ios.keywords,promotionalText:l.value.ios.promotionalText,description:l.value.ios.description,releaseNotes:l.value.ios.releaseNotes,title:l.value.android.title,shortDescription:l.value.android.shortDescription,fullDescription:l.value.android.fullDescription,androidReleaseNotes:l.value.android.releaseNotes}};u.value=await $fetch("/api/mobile/metadata",{method:"POST",body:h}),v.value=u.value?.issues?.ios||[],m.value=u.value?.issues?.android||[],p.value=v.value.length===0&&m.value.length===0},E=async()=>{w.value=!0,A.value=null,c.value=null;try{const h=(d.value||"").replace(/```[a-zA-Z]*\s*/g,"").replace(/```/g,"").trim();c.value=await $fetch("/api/mobile/ios-plist",{method:"POST",body:{plist:h}}),c.value||(A.value="Aucun résultat reçu.")}catch(h){const r=h?.data?.statusMessage||h?.message;A.value=r||"Analyse échouée. Vérifiez que vous collez le Info.plist brut (XML)."}finally{w.value=!1}},I=async()=>{V.value=!0,L.value=null,x.value=null;try{const h=(_.value||"").replace(/```[a-zA-Z]*\s*/g,"").replace(/```/g,"").trim();x.value=await $fetch("/api/mobile/android-manifest",{method:"POST",body:{manifestXml:h}})}catch(h){L.value=h?.data?.statusMessage||h?.message||"Analyse échouée. Vérifiez le XML."}finally{V.value=!1}},C=()=>{n.value="meta",l.value={ios:{name:"",subtitle:"",keywords:"",promotionalText:"",description:"",releaseNotes:""},android:{title:"",shortDescription:"",fullDescription:"",releaseNotes:""}},u.value=null,v.value=[],m.value=[],p.value=!1,d.value="",c.value=null,w.value=!1,A.value=null,_.value="",x.value=null,V.value=!1,L.value=null},S=()=>{C()};return ne(()=>{window.addEventListener("project-checklist-changed",S)}),ie(()=>{window.removeEventListener("project-checklist-changed",S)}),f({reset:C}),(h,r)=>(t(),s("div",Fa,[e("div",Ha,[e("button",{class:q(["btn",{"btn-primary":n.value==="meta"}]),onClick:r[0]||(r[0]=a=>n.value="meta")},"Métadonnées",2),e("button",{class:q(["btn",{"btn-primary":n.value==="ios"}]),onClick:r[1]||(r[1]=a=>n.value="ios")},"iOS (Info.plist)",2),e("button",{class:q(["btn",{"btn-primary":n.value==="android"}]),onClick:r[2]||(r[2]=a=>n.value="android")},"Android (Manifest)",2)]),n.value==="meta"?(t(),s("div",Xa,[e("div",Ka,[F(e("input",{"onUpdate:modelValue":r[3]||(r[3]=a=>l.value.ios.name=a),placeholder:"Nom (iOS) ≤ 30",class:"input"},null,512),[[H,l.value.ios.name]]),F(e("input",{"onUpdate:modelValue":r[4]||(r[4]=a=>l.value.ios.subtitle=a),placeholder:"Sous‑titre ≤ 30",class:"input"},null,512),[[H,l.value.ios.subtitle]]),F(e("input",{"onUpdate:modelValue":r[5]||(r[5]=a=>l.value.ios.keywords=a),placeholder:"Mots‑clés (≤100)",class:"input"},null,512),[[H,l.value.ios.keywords]]),F(e("input",{"onUpdate:modelValue":r[6]||(r[6]=a=>l.value.ios.promotionalText=a),placeholder:"Texte promo ≤ 170",class:"input"},null,512),[[H,l.value.ios.promotionalText]])]),F(e("textarea",{"onUpdate:modelValue":r[7]||(r[7]=a=>l.value.ios.description=a),rows:"4",placeholder:"Description iOS ≤ 4000",class:"textarea"},null,512),[[H,l.value.ios.description]]),F(e("input",{"onUpdate:modelValue":r[8]||(r[8]=a=>l.value.ios.releaseNotes=a),placeholder:"Notes de version iOS ≤ 4000",class:"input"},null,512),[[H,l.value.ios.releaseNotes]]),r[16]||(r[16]=e("hr",{class:"my-3"},null,-1)),e("div",Za,[F(e("input",{"onUpdate:modelValue":r[9]||(r[9]=a=>l.value.android.title=a),placeholder:"Titre (Android) ≤ 30",class:"input"},null,512),[[H,l.value.android.title]]),F(e("input",{"onUpdate:modelValue":r[10]||(r[10]=a=>l.value.android.shortDescription=a),placeholder:"Courte description ≤ 80",class:"input"},null,512),[[H,l.value.android.shortDescription]])]),F(e("textarea",{"onUpdate:modelValue":r[11]||(r[11]=a=>l.value.android.fullDescription=a),rows:"4",placeholder:"Description Android ≤ 4000",class:"textarea"},null,512),[[H,l.value.android.fullDescription]]),F(e("input",{"onUpdate:modelValue":r[12]||(r[12]=a=>l.value.android.releaseNotes=a),placeholder:"Notes de version Android ≤ 500",class:"input"},null,512),[[H,l.value.android.releaseNotes]]),e("div",{class:"flex gap-2"},[e("button",{class:"btn btn-primary",onClick:O},"Vérifier")]),u.value?(t(),s("div",Wa,[r[15]||(r[15]=e("p",{class:"font-medium"},"Résultats",-1)),p.value?(t(),s("div",Ja," Aucun problème détecté selon ces règles. ")):(t(),s("div",Qa,[v.value.length?(t(),s("div",Ga,[e("p",Ya,"iOS ("+i(v.value.length)+")",1),e("ul",er,[(t(!0),s(z,null,N(v.value,(a,T)=>(t(),s("li",{key:"ios"+T},i(a),1))),128))])])):g("",!0),m.value.length?(t(),s("div",tr,[e("p",sr,"Android ("+i(m.value.length)+")",1),e("ul",or,[(t(!0),s(z,null,N(m.value,(a,T)=>(t(),s("li",{key:"andr"+T},i(a),1))),128))])])):g("",!0)])),u.value?.hints?(t(),s("p",lr,"iOS: "+i(u.value.hints.ios)+" | Android: "+i(u.value.hints.android),1)):g("",!0)])):g("",!0)])):n.value==="ios"?(t(),s("div",ar,[$(ke,{modelValue:d.value,"onUpdate:modelValue":r[13]||(r[13]=a=>d.value=a),rows:12,label:"Info.plist (XML)",placeholder:"Collez votre Info.plist (XML)","clean-markdown":!0},null,8,["modelValue"]),e("div",rr,[e("button",{class:"btn btn-primary",disabled:w.value,onClick:E},[w.value?(t(),s("span",ir,"Analyse…")):(t(),s("span",cr,"Analyser"))],8,nr),A.value?(t(),s("span",dr,i(A.value),1)):g("",!0)]),c.value&&c.value.issues&&c.value.issues.length?(t(),s("ul",ur,[(t(!0),s(z,null,N(c.value.issues,(a,T)=>(t(),s("li",{key:T},i(a),1))),128))])):c.value&&!A.value?(t(),s("div",mr," Aucun problème détecté selon ces règles. ")):g("",!0)])):(t(),s("div",vr,[$(ke,{modelValue:_.value,"onUpdate:modelValue":r[14]||(r[14]=a=>_.value=a),rows:12,label:"AndroidManifest.xml",placeholder:"Collez votre AndroidManifest.xml","clean-markdown":!0},null,8,["modelValue"]),e("div",pr,[e("button",{class:"btn btn-primary",disabled:V.value,onClick:I},[V.value?(t(),s("span",hr,"Analyse…")):(t(),s("span",fr,"Analyser"))],8,yr),L.value?(t(),s("span",xr,i(L.value),1)):g("",!0)]),x.value?.issues?.length?(t(),s("ul",br,[(t(!0),s(z,null,N(x.value.issues,(a,T)=>(t(),s("li",{key:T},i(a),1))),128))])):g("",!0)]))]))}}),kr=Object.assign(ue(gr,[["__scopeId","data-v-920bcb40"]]),{__name:"DashboardAppPreflightAccordion"}),_r={class:"px-4 lg:px-6 py-6 pb-24 w-full bg-[var(--bg-primary)]",style:{height:"calc(100vh - 77px)"}},wr={key:0,class:"card p-6 mb-6",style:{"background-color":"var(--bg-surface)",border:"1px solid var(--bg-border)"}},$r={class:"flex items-start justify-between mb-4"},Cr=["title","aria-label"],jr={class:"text-sm font-semibold"},Sr={class:"flex items-center justify-center gap-6 text-sm"},Pr={class:"text-center"},Ir={class:"text-2xl font-bold",style:{color:"var(--text-primary)"}},Er={class:"text-xs font-medium",style:{color:"var(--text-secondary)"}},Ar={class:"text-center"},Tr={class:"text-2xl font-bold",style:{color:"var(--text-primary)"}},Vr={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6 items-start"},Lr={class:"lg:col-span-2"},Or={class:"lg:col-span-1"},Mr={key:0,class:"hidden lg:block"},Ur={key:1,class:"block lg:hidden"},Dr={key:2},qr={key:3},Rr={key:2,class:"min-h-[calc(100vh-200px)] flex items-center justify-center"},zr={class:"text-base text-gray-600 dark:text-gray-300"},Zr={__name:"dashboard",setup(o,{expose:f}){const n=b(null),l=b(null),u=b(null),v=b(null),m=b(null),p=b(!1),d=b(!1),c=de(),{currentUser:w}=me(),A=U(()=>c.hasProjects),_=U(()=>c.currentProjectId),x=U(()=>c.currentProject);oe([x,A],([S,h])=>{h&&S&&!S.checklistType&&ye("/select-checklist")},{immediate:!0}),oe(_,async(S,h)=>{if(S&&S!==h)try{await re();const r=x.value?.checklistType;r==="security-checker"?m.value&&await m.value.reset():r==="appstore-preflight"?v.value&&await v.value.reset():(l.value&&await l.value.reset(),u.value&&await u.value.reset())}catch{}}),ne(()=>{p.value=!0,window.addEventListener("reset-checklist-progress",L)});const V=S=>{S&&!S.checklistType&&ye("/select-checklist")},L=()=>{n.value&&n.value.resetProgress&&n.value.resetProgress()},O=async S=>{try{const h=c.currentProjectId;if(!h||!w?.value)return;const r=c.getCheckedSet(h);S.forEach(a=>r.add(a)),c.setCheckedForProject(h,r),await c.saveProjectChecked(w.value.uid,h),window.dispatchEvent(new CustomEvent("checked-items-updated",{detail:{projectId:h,itemIds:S}}))}catch{}},E=()=>{d.value=!0},I=()=>{n.value&&n.value.resetProgress&&(n.value.resetProgress(),window.dispatchEvent(new CustomEvent("reset-checklist-progress"))),d.value=!1},C=()=>{d.value=!1};return ie(()=>{window.removeEventListener("reset-checklist-progress",L)}),f({handleResetProgress:L}),(S,h)=>{const r=X;return t(),s(z,null,[e("div",_r,[p.value&&_.value&&x.value?.checklistType?(t(),s("div",wr,[e("div",$r,[h[1]||(h[1]=e("div",{class:"flex-1"},[e("div",{class:"text-center mb-2"},[e("h1",{class:"text-2xl font-bold",style:{color:"var(--text-primary)"}},"Checklist Pré-Déploiement"),e("p",{class:"text-sm",style:{color:"var(--text-secondary)"}},"Vérifiez tous les aspects essentiels avant de mettre votre site en ligne")])],-1)),e("button",{onClick:E,class:"flex items-center space-x-3 px-5 py-3 rounded-xl transition-all duration-200 hover:shadow-lg hover:bg-opacity-90",style:{backgroundColor:"var(--button-bg)",borderColor:"var(--button-border)",color:"var(--text-primary)"},title:S.$t("common.resetTitle"),"aria-label":S.$t("common.resetDescription")},[$(r,{name:"heroicons:arrow-path",class:"w-5 h-5",style:{color:"var(--text-secondary)"},"aria-hidden":"true"}),e("span",jr,i(S.$t("common.reset")),1)],8,Cr)]),e("div",Sr,[e("div",Pr,[e("div",Ir,i(te(c).currentProjectScores?.completedItems||0),1),e("div",Er,"sur "+i(te(c).currentProjectScores?.totalItems||44)+" complétés",1)]),h[3]||(h[3]=e("div",{class:"w-px h-8",style:{"background-color":"var(--bg-border)"}},null,-1)),e("div",Ar,[e("div",Tr,i(Math.round(te(c).currentProjectScores?.percentage||0))+"%",1),h[2]||(h[2]=e("div",{class:"text-xs font-medium",style:{color:"var(--text-secondary)"}},"progression",-1))])])])):g("",!0),p.value&&_.value&&x.value?.checklistType?(t(),s("div",Vr,[e("div",Lr,[$(Rs,{ref_key:"seoChecklist",ref:n,"current-project-id":_.value,"checklist-type":te(c).currentProject?.checklistType||"web-prelaunch"},null,8,["current-project-id","checklist-type"])]),e("div",Or,[x.value?.checklistType!=="security-checker"&&x.value?.checklistType!=="appstore-preflight"?(t(),s("div",Mr,[$(ge,{ref_key:"lighthouseAccordion",ref:l,"default-expanded":!0,"project-type":x.value?.checklistType},null,8,["project-type"])])):g("",!0),x.value?.checklistType!=="security-checker"&&x.value?.checklistType!=="appstore-preflight"?(t(),s("div",Ur,[$(ge,{ref_key:"lighthouseAccordionMobile",ref:u,"default-expanded":!1,"project-type":x.value?.checklistType},null,8,["project-type"])])):g("",!0),x.value?.checklistType==="appstore-preflight"?(t(),s("div",Dr,[$(kr,{ref_key:"appPreflightAccordion",ref:v},null,512)])):g("",!0),x.value?.checklistType==="security-checker"?(t(),s("div",qr,[$(Ua,{ref_key:"securityScannerAccordion",ref:m,onItemsAutochecked:O},null,512)])):g("",!0)])])):(t(),s("div",Rr,[$(Ke,{onCreateProject:V})]))]),$(Oe,{"is-open":d.value,"onUpdate:isOpen":h[0]||(h[0]=a=>d.value=a),title:S.$t("common.resetTitle"),onClose:C},{footer:be(()=>[e("button",{onClick:C,class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"},i(S.$t("common.cancel")),1),e("button",{onClick:I,class:"px-4 py-2 rounded-lg font-medium transition-colors duration-200 bg-emerald-500 text-white hover:bg-emerald-600"},i(S.$t("common.reset")),1)]),default:be(()=>[e("p",zr,i(S.$t("common.resetConfirm")),1)]),_:1},8,["is-open","title"])],64)}}};export{Zr as default};
